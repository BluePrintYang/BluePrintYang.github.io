<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é˜¿é‡Œ3æœˆ23æ—¥ç¬”è¯•</title>
      <link href="/2020/03/23/%E9%98%BF%E9%87%8C3%E6%9C%8823%E6%97%A5%E7%AC%94%E8%AF%95/"/>
      <url>/2020/03/23/%E9%98%BF%E9%87%8C3%E6%9C%8823%E6%97%A5%E7%AC%94%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€é¢˜"><a class="header-anchor" href="#ç¬¬ä¸€é¢˜"></a>ç¬¬ä¸€é¢˜</h2><blockquote><p>è¾“å…¥ä¸€ä¸ªæ•´æ•°n 1&lt;n&lt;10<sup>9</sup><br>è¾“å‡ºä¸€ä¸ªæ•´æ•°<br>æ‰¾å‡ºå…¶æ‰€æœ‰éç©ºå­é›†ä¸­æ‰€æœ‰å…ƒç´ ä¸ªæ•°ä¹‹å’Œï¼Œç„¶åå¯¹10<sup>9</sup>+7å–æ¨¡ï¼Œè¾“å‡ºç»“æœ<br>ä¾‹å¦‚è¾“å…¥2ï¼Œæœ‰{1}ï¼Œ{2}ï¼Œ{1ï¼Œ2}3ä¸ªéç©ºå­é›†ï¼Œæ‰€æœ‰å…ƒç´ ä¸ªæ•°ä¹‹å’Œä¸º4<br>è¾“å‡ºç»“æœä¸º4</p></blockquote><a id="more"></a><h3 id="æ€è·¯"><a class="header-anchor" href="#æ€è·¯"></a>æ€è·¯</h3><p>ç”¨intè‚¯å®šä¼šè¶…ï¼Œéœ€è¦ç”¨åˆ°BigInteger</p><p>å¯¹äºè¾“å…¥nï¼Œæ±‚å¾—æ‰€æœ‰å…ƒç´ ä¹‹å’Œä¸ºn*2<sup>n-1</sup></p><p>ç„¶åå†å¯¹10<sup>7</sup>+7å–æ¨¡å³å¯</p><h3 id="ä»£ç "><a class="header-anchor" href="#ä»£ç "></a>ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String n = sc.next();</span><br><span class="line">        BigInteger in = BigInteger.valueOf(Long.parseLong(n));</span><br><span class="line">        BigInteger num = f(in);<span class="comment">//ç§æ•°</span></span><br><span class="line">        BigInteger x = BigInteger.valueOf(<span class="number">10</span>).pow(<span class="number">9</span>).add(BigInteger.valueOf(<span class="number">7</span>));</span><br><span class="line">        System.out.println(num.mod(x));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> BigInteger <span class="title">f</span><span class="params">(BigInteger n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n.multiply(BigInteger.valueOf(<span class="number">2</span>).pow(n.intValue()-<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¬¬äºŒé¢˜"><a class="header-anchor" href="#ç¬¬äºŒé¢˜"></a>ç¬¬äºŒé¢˜</h2><blockquote><p>è¾“å…¥n,mä¸¤ä¸ªæ•´æ•°ä»£è¡¨nè¡Œmåˆ—<br>ä¸‹é¢è¾“å…¥nè¡Œå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½åŒ…å«mä¸ªå­—ç¬¦ï¼ˆåªå«æœ‰â€™.â€™,â€™#â€™,â€˜Eâ€™,â€˜Sâ€™ï¼‰<br>å…¶ä¸­Sä»£è¡¨èµ·ç‚¹ï¼ŒEä»£è¡¨ç»ˆç‚¹ï¼Œ#ä»£è¡¨æ— æ³•é€šè¿‡<br>ä»èµ·ç‚¹å‡ºå‘ï¼Œå¯å‘å·¦ï¼Œå‘å³ï¼Œå‘ä¸Šï¼Œå‘ä¸‹ç§»åŠ¨ä¸€æ­¥<br>ä¹Ÿå¯æŒ‰å¦‚ä¸‹ä¸­å¿ƒå¯¹ç§°ç§»åŠ¨ï¼Œä¹Ÿåªç®—ç§»åŠ¨ä¸€æ­¥<br>Xï¼ˆi,jï¼‰â†’  Xâ€˜ï¼ˆn+1-i,m+1-jï¼‰<br>æ±‚ä»èµ·ç‚¹åˆ°ç»ˆç‚¹æœ€å°‘éœ€è¦ç§»åŠ¨å‡ æ­¥</p></blockquote><p>ç¤ºä¾‹è¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4 4</span><br><span class="line">#S..</span><br><span class="line">E#..</span><br><span class="line">#...</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4</span><br></pre></td></tr></table></figure><p>è¯´æ˜<br>å…ˆä¸­å¿ƒå¯¹ç§°åˆ°è¾¾ï¼ˆ4ï¼Œ3ï¼‰ï¼Œç„¶åå‘ä¸Šä¸€æ­¥ï¼Œå‘å³ä¸€æ­¥ï¼Œä¸­å¿ƒå¯¹ç§°åˆ°è¾¾ç»ˆç‚¹</p><p>ç¬¬2é¢˜æˆ‘è¿˜æ²¡åšå®Œåˆ°æ—¶é—´äº†ğŸ˜­</p><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç¬”è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HashMapæºç åˆ†æ</title>
      <link href="/2020/03/14/HashMap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
      <url>/2020/03/14/HashMap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h2 id="hashmapçš„ç®€å•ä½¿ç”¨"><a class="header-anchor" href="#hashmapçš„ç®€å•ä½¿ç”¨"></a>HashMapçš„ç®€å•ä½¿ç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHashMap</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"a"</span>,<span class="string">"aaa"</span>);</span><br><span class="line">        map.put(<span class="string">"b"</span>,<span class="string">"bbb"</span>);</span><br><span class="line">        map.put(<span class="string">"c"</span>,<span class="string">"ccc"</span>);</span><br><span class="line">        map.put(<span class="string">"d"</span>,<span class="string">"ddd"</span>);</span><br><span class="line">        map.put(<span class="string">"e"</span>,<span class="string">"eee"</span>);</span><br><span class="line">        System.out.println(map.get(<span class="string">"a"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœï¼šaaa</span></span><br></pre></td></tr></table></figure><p>HashMapå­˜å‚¨Key-Valueï¼ˆé”®å€¼å¯¹ï¼‰æ•°æ®</p><a id="more"></a><h2 id="hashmapå®ç°åŸç†"><a class="header-anchor" href="#hashmapå®ç°åŸç†"></a>HashMapå®ç°åŸç†</h2><p>åœ¨Java8ä¹‹å‰ï¼Œé€šè¿‡æ•°ç»„+é“¾è¡¨å®ç°</p><p>Java8ä¸­ï¼Œæ”¹ä¸ºæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ã€‚å½“é“¾è¡¨é•¿åº¦è¶…è¿‡8æ—¶ï¼Œå°†é“¾è¡¨æ”¹ä¸ºçº¢é»‘æ ‘ï¼Œé™ä½æ•°æ®æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦</p><p>HashMapæˆå‘˜</p><p>ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œé¢æ¯ä¸ªå…ƒç´ éƒ½æ˜¯é“¾è¡¨</p><p>é“¾è¡¨å­˜å‚¨å¯¹è±¡(Entry)ï¼šåŒ…æ‹¬Keyï¼ŒValueï¼Œnextï¼Œhash</p><h2 id="hashmapç®€å•å®ç°"><a class="header-anchor" href="#hashmapç®€å•å®ç°"></a>HashMapç®€å•å®ç°</h2><p>å®šä¹‰Mapæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K k,V v)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(K k)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> K <span class="title">getKey</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> V <span class="title">getValue</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HashMapç®€å•å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHashMap</span>&lt;<span class="title">K</span>, <span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">MyMap</span>&lt;<span class="title">K</span>, <span class="title">V</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ•°ç»„åŠ é“¾è¡¨</span></span><br><span class="line">    <span class="keyword">private</span> Entry&lt;K, V&gt;[] table;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> defaultLength = <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyHashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        table = <span class="keyword">new</span> Entry[defaultLength];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K k, V v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.keyè¿›è¡Œhash  2.å¯¹åº”æ•°ç»„ä¸‹æ ‡  3.å¦‚æœæ˜¯null  4.æ˜¯å¦å¯ä»¥å­˜å‚¨</span></span><br><span class="line">        <span class="keyword">int</span> index = hash(k);</span><br><span class="line">        Entry&lt;K, V&gt; entry = table[index];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == entry) &#123;</span><br><span class="line">            table[index] = <span class="keyword">new</span> Entry&lt;&gt;(k, v, <span class="keyword">null</span>, index);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            table[index] = <span class="keyword">new</span> Entry&lt;&gt;(k, v, entry, index);</span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> table[index].getValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(K k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = k.hashCode() % (defaultLength - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> Math.abs(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(K k)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//hashå‡ºæ¥çš„index  è·å–åˆ°å½“å‰Entryå¯¹è±¡  åˆ¤æ–­å¯¹è±¡æœ‰æ²¡æœ‰å€¼  æ¯”è¾ƒ åœ¨ç»§ç»­æŸ¥æ‰¾ç›´åˆ°  key  hashcode</span></span><br><span class="line">        <span class="keyword">int</span> index = hash(k);</span><br><span class="line"></span><br><span class="line">        Entry&lt;K, V&gt; entry = getEntry(k, index);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> entry == <span class="keyword">null</span> ? <span class="keyword">null</span> : entry.getValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Entry&lt;K, V&gt; <span class="title">getEntry</span><span class="params">(K k, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;K, V&gt; entry = table[index]; entry != <span class="keyword">null</span>; entry = entry.next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (entry.hash == index &amp;&amp; (k == entry.getKey() || k.equals(entry.getKey()))) &#123;</span><br><span class="line">                <span class="keyword">return</span> entry;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>, <span class="title">V</span>&gt; <span class="keyword">implements</span>  <span class="title">MyMap</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>, <span class="title">V</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        K k;</span><br><span class="line">        V v;</span><br><span class="line">        MyHashMap.Entry&lt;K, V&gt; next;</span><br><span class="line">        <span class="keyword">int</span> hash;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Entry</span><span class="params">(K k, V v, MyHashMap.Entry&lt;K, V&gt; next, <span class="keyword">int</span> hash)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.k = k;</span><br><span class="line">            <span class="keyword">this</span>.v = v;</span><br><span class="line">            <span class="keyword">this</span>.next = next;</span><br><span class="line">            <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> K <span class="title">getKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> k;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> V <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMyHashMap</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyMap&lt;String, String&gt; map = <span class="keyword">new</span> MyHashMap();</span><br><span class="line">        map.put(<span class="string">"yll"</span>, <span class="string">"yll"</span>);</span><br><span class="line">        System.out.println(map.get(<span class="string">"yll"</span>));</span><br><span class="line">        System.out.println(map.size());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*è¿è¡Œç»“æœï¼š</span></span><br><span class="line"><span class="comment">yll</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œåªå®ç°äº†Java8ä¹‹å‰çš„æ•°ç»„åŠ é“¾è¡¨å½¢å¼</p><h2 id="hashmapæ³¨æ„äº‹é¡¹"><a class="header-anchor" href="#hashmapæ³¨æ„äº‹é¡¹"></a>HashMapæ³¨æ„äº‹é¡¹</h2><p>HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œputæ–¹æ³•å’Œæ‰©å®¹æ—¶éƒ½æ˜¯ä¸å®‰å…¨çš„</p><p>ä½†æ˜¯getæ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„</p><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowså®šæ—¶å…³æœºç¨‹åº</title>
      <link href="/2020/01/02/windows%E5%AE%9A%E6%97%B6%E5%85%B3%E6%9C%BA%E7%A8%8B%E5%BA%8F/"/>
      <url>/2020/01/02/windows%E5%AE%9A%E6%97%B6%E5%85%B3%E6%9C%BA%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸå› "><a class="header-anchor" href="#åŸå› "></a>åŸå› </h2><blockquote><p>ä¸€ååœ¨ç”µè„‘å‰å°±åœä¸ä¸‹æ¥ï¼Œåˆ«çš„ä»€ä¹ˆäº‹æƒ…éƒ½å¿˜äº†ğŸ¤¦â€â™‚ï¸</p><p>æ¯æ¬¡è¯´å†çœ‹10åˆ†é’Ÿå°±ä¸çœ‹äº†ï¼Œå¾€å¾€1ä¸ªå°æ—¶ä¹‹åéƒ½æ˜¯è¿˜ååœ¨ç”µè„‘å‰çš„ï¼Œå°¤å…¶æ˜¯æ™šä¸Šï¼Œè€æ˜¯å› æ­¤ç†¬å¤œã€‚</p><p>æ‰€ä»¥å¹²è„†æä¸ªå®šæ—¶è‡ªåŠ¨å…³æœºï¼Œå‡ºå…¶ä¸æ„ï¼Œä¸€åˆ°æ—¶é—´ç”µè„‘ç«‹åˆ»å…³æœºï¼Œå“ˆå“ˆæ²¡æƒ³åˆ°å§ğŸ˜ˆ</p></blockquote><p>åœ¨win10ä¸­ç®€å•æœäº†ä¸€ä¸‹ï¼Œå¥½åƒæ²¡æœ‰å®šæ—¶å…³æœºçš„åŠŸèƒ½ã€‚cmdä¸­æ˜¯å¯ä»¥çš„å•¦ï¼Œä¸‹é¢è¿™ä¸ªvbså…¶å®ä¹Ÿæ˜¯ç”¨çš„cmdå‘½ä»¤</p><a id="more"></a><h2 id="æºç "><a class="header-anchor" href="#æºç "></a>æºç </h2><p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ã€‚ä½¿ç”¨vbså®ç°ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¥½æ‡‚çš„ï¼Œæˆ‘å…¶å®ä¹Ÿæ²¡å­¦è¿‡vbsï¼Œæ¬¢è¿å¤§ä½¬æ‰¹è¯„æŒ‡æ­£ã€‚</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> ws=<span class="built_in">createobject</span>(<span class="string">"wscript.shell"</span>)</span><br><span class="line">x=<span class="built_in">msgbox</span>(<span class="string">"ç¡®å®šè¦å…³æœºå—ï¼Ÿ"</span>,vbYesNo)</span><br><span class="line"><span class="keyword">if</span> x=vbYes <span class="keyword">then</span></span><br><span class="line">    y=<span class="built_in">CDbl</span>(<span class="built_in">inputbox</span>(<span class="string">"è¾“å…¥æ•°å­—(1~120)ï¼šxåˆ†é’Ÿåå…³æœºï¼Œå–æ¶ˆç«‹åˆ»å…³æœº"</span>))</span><br><span class="line">    a=y*<span class="number">60</span></span><br><span class="line">    <span class="keyword">if</span> y&gt;=<span class="number">1</span> <span class="keyword">and</span> y&lt;=<span class="number">120</span> <span class="keyword">then</span></span><br><span class="line">        ws.run <span class="string">"cmd.exe /c shutdown -s -t"</span>&amp;<span class="string">" "</span>&amp;a </span><br><span class="line">            </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        ws.run <span class="string">"cmd.exe /c shutdown -s -t 0"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">if</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">msgbox</span>(<span class="string">"æœ‰é‡è¦çš„äº‹æƒ…è¿˜æ˜¯å…³æ‰ç”µè„‘å§ï¼Œè¿˜æœ‰ï¼Œä¸è¦ç†¬å¤œå“¦~"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span></span><br></pre></td></tr></table></figure><p>åªæœ‰åå‡ è¡Œä»£ç ï¼Œå®é™…ä¸Šå°±æ˜¯ä½¿ç”¨<code>cmd</code>å‘½ä»¤<code>shutdown</code>å†åŠ ä¸ªæ—¶é—´æ¥å®ç°å…³æœº</p><p>â­ï¸å£°æ˜ï¼šä¸Šé¢çš„ä»£ç å¯ä»¥è‡ªå®šä¹‰1-120åˆ†é’Ÿè‡ªåŠ¨å…³æœºï¼Œå¦‚æœè¾“å…¥1-120ä»¥å¤–çš„æ•°å­—æˆ–è€…ç‚¹å–æ¶ˆéƒ½ä¼šç«‹åˆ»å…³æœºã€‚å¯ä»¥æ”¹<code>if y&gt;=1 and y&lt;=120</code>ä¸­çš„æ•°å­—è‡ªè¡Œå¢åŠ æ—¶é—´èŒƒå›´ã€‚</p><h2 id="ä½¿ç”¨æ–¹æ³•"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><ol><li><p>åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ”¹æ‰©å±•åä¸ºshutdown.vbsï¼Œcopyä¸Šé¢ä»£ç ä¿å­˜å³å¯</p></li><li><p>åŒå‡»shutdown.vbsæ–‡ä»¶è¿è¡Œ</p></li></ol><blockquote><p>å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶æ”¾åœ¨æ¡Œé¢æ–¹ä¾¿ç›´æ¥è¿è¡Œ</p></blockquote><h2 id="æ•ˆæœå±•ç¤º"><a class="header-anchor" href="#æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p>è¾“å…¥25åç¡®å®šï¼ˆä¹Ÿå°±æ˜¯25åˆ†é’Ÿåå…³æœºï¼‰</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/20200102235140.png" alt=""></p><h2 id="å–æ¶ˆå…³æœº"><a class="header-anchor" href="#å–æ¶ˆå…³æœº"></a>å–æ¶ˆå…³æœº</h2><p>å¦‚æœçœŸçš„æœ‰ç´§æ€¥æƒ…å†µéœ€è¦å–æ¶ˆï¼Œå¯ä»¥åœ¨cmdä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -a</span><br></pre></td></tr></table></figure><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/20200102235355.png" alt=""></p><blockquote><p>ä¸€èˆ¬æƒ…å†µä¸‹å°±ä¸è¦ç”¨äº†å˜›ï¼Œä¸ç„¶å°±æ²¡æ„ä¹‰äº†ã€‚è€Œä¸”å¦‚æœæ˜¯ç«‹åˆ»å…³æœºï¼Œåº”è¯¥æ˜¯æ¥ä¸åŠå–æ¶ˆçš„ğŸ¶</p></blockquote><p>ä½†æ˜¯windowsæœ‰æ—¶å€™å…³æœºå¹¶ä¸æ˜¯ç›´æ¥å°±å…³äº†ï¼Œå®ƒå¯èƒ½è¿˜ä¼šæé†’æœ‰æœªä¿å­˜çš„å·¥ä½œå•¥çš„ï¼Œåˆç»™äº†ä¸€æ¬¡è‹Ÿå»¶æ®‹å–˜çš„æœºä¼šã€‚ã€‚ã€‚</p><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      <categories>
          
          <category> ä¸çŸ¥é“åˆ†å•¥ç±» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vbs </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/2019/12/13/test/"/>
      <url>/2019/12/13/test/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œæœ‰ä¸€ä¸ªåˆ†å‰²çº¿</p><hr><a id="more"></a><p>I am here!</p><h2 id="æµ‹è¯•å±…ä¸­"><a class="header-anchor" href="#æµ‹è¯•å±…ä¸­"></a>æµ‹è¯•å±…ä¸­</h2><!-- HTMLæ–¹å¼: ç›´æ¥åœ¨ Markdown æ–‡ä»¶ä¸­ç¼–å†™ HTML æ¥è°ƒç”¨ --><!-- å…¶ä¸­ class="blockquote-center" æ˜¯å¿…é¡»çš„ --><blockquote class="blockquote-center">blah blah blah</blockquote><!-- æ ‡ç­¾ æ–¹å¼ï¼Œè¦æ±‚ç‰ˆæœ¬åœ¨0.4.5æˆ–ä»¥ä¸Š --><blockquote class="blockquote-center"><p>blah blah blah</p></blockquote><!-- æ ‡ç­¾åˆ«å --><blockquote class="blockquote-center"><p>blah blah blah</p></blockquote><blockquote class="blockquote-center"><p>æµ‹è¯•å±…ä¸­</p></blockquote><h2 id="æµ‹è¯•emoji"><a class="header-anchor" href="#æµ‹è¯•emoji"></a>æµ‹è¯•emoji</h2><p>â­ï¸ ğŸ’¯ â˜‘ï¸ 6ï¸âƒ£ 5ï¸âƒ£</p><p>ğŸ¤™</p><h2 id="æµ‹è¯•ä¸Šæ ‡ä¸‹æ ‡"><a class="header-anchor" href="#æµ‹è¯•ä¸Šæ ‡ä¸‹æ ‡"></a>æµ‹è¯•ä¸Šæ ‡ä¸‹æ ‡</h2><p>2<sup>2</sup></p><p>â­ï¸</p><p>2<sup>2</sup></p><p>H<sub>2</sub>O</p><h2 id="æµ‹è¯•å…¬å¼"><a class="header-anchor" href="#æµ‹è¯•å…¬å¼"></a>æµ‹è¯•å…¬å¼</h2><p>$$<br>2+2=4<br>$$</p><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€æ¬¡ç»™é˜¿é‡Œå·´å·´fastjsonä¿®bugçš„å­¦ä¹ ç»å†</title>
      <link href="/2019/12/11/%E4%B8%80%E6%AC%A1%E7%BB%99%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4fastjson%E4%BF%AEbug%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%BB%8F%E5%8E%86/"/>
      <url>/2019/12/11/%E4%B8%80%E6%AC%A1%E7%BB%99%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4fastjson%E4%BF%AEbug%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>fastjsonä¹Ÿæ˜¯æˆ‘æœ€è¿‘æœ‰ç”¨åˆ°çš„ä¸€ä¸ªå¼€æºåº“</p><p>è¿™æ˜¯æˆ‘åœ¨Bç«™å­¦ä¹ åˆ°çš„ï¼Œä¸‹é¢é™„ä¸Šè§†é¢‘é“¾æ¥</p></blockquote><p><a href="https://www.bilibili.com/video/av77302131" target="_blank" rel="noopener">è§†é¢‘é“¾æ¥</a></p><a id="more"></a><h2 id="æ‰¾bugæ ‡å‡†"><a class="header-anchor" href="#æ‰¾bugæ ‡å‡†"></a>æ‰¾bugæ ‡å‡†</h2><ol><li>bugèƒ½å¤ç°</li><li>bugæ¯”è¾ƒé‡è¦ï¼Œä¹Ÿå°±æ˜¯è¯´å¾ˆå¤šäººéƒ½å‡ºç°è¿‡è¿™ä¸ªbug</li></ol><h2 id="æ‰¾åˆ°bug"><a class="header-anchor" href="#æ‰¾åˆ°bug"></a>æ‰¾åˆ°bug</h2><p>æ‰¾åˆ°çš„bugï¼šfastjsonæ— æ³•ååºåˆ—åŒ–è¶…å‡ºæŸç§é™åˆ¶çš„ç±»#2779  ä¸‹é¢æœ‰bugé“¾æ¥</p><p><a href="https://github.com/alibaba/fastjson/issues/2779" target="_blank" rel="noopener">bugé“¾æ¥</a></p><p>é¦–å…ˆä½¿ç”¨git clone fastjsoné¡¹ç›®ï¼Œåœ¨ideaä¸­æ‰“å¼€</p><p>è¿›å…¥teståŒ…ï¼Œå‘ç°java.alibaba.fastjson.deserializeråŒ…ä¸‹å·²ç»æœ‰issue2779çš„æµ‹è¯•ç±»äº†</p><p>å½“ç„¶ï¼Œè¿™æ˜¯upä¸»å·²ç»ä¿®å¤çš„ç‰ˆæœ¬å•¦ï¼Œæˆ‘ä»¬è¿è¡Œå‘ç°å¹¶æ²¡æœ‰æŠ¥é”™ï¼Œå“ˆå“ˆå“ˆ</p><h2 id="å¤ç°bug"><a class="header-anchor" href="#å¤ç°bug"></a>å¤ç°bug</h2><p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨gitå›é€€åˆ°upä¸»è¿˜æ²¡ä¿®å¤æˆåŠŸçš„ç‰ˆæœ¬</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/revertto10_29.png" alt="image-20191211113613380"></p><p>ä»–æ˜¯11.4ä¿®å¤çš„ï¼Œæˆ‘ä»¬å›é€€åˆ°ä¸‹é¢çš„10.29</p><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠissue2779åŒ…é‡Œé¢çš„ä¸¤ä¸ªæ–‡ä»¶åœ¨æœ¬åœ°è¿›è¡Œä¿®æ”¹ä¸€ä¸‹ï¼ˆæŒ‰å›è½¦å¢åŠ ä¸€è¡Œå°±å¯ä»¥ï¼‰ï¼Œä»¥å…å›é€€çš„æ—¶å€™è¿™ä¸ªåŒ…ç›´æ¥æ¶ˆå¤±äº†</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/gitreset.png" alt=""></p><p>ä¸Šå›¾é€‰é”™äº†ï¼Œåº”è¯¥é€‰æ‹©Keepâ†’Reset</p><p>çœ‹åé¢çš„ä¿¡æ¯å°±å¯ä»¥çŸ¥é“ï¼Œé€‰æ‹©keepæœ¬åœ°ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯åˆšæ‰ä¿®æ”¹çš„issue2779åŒ…å†…çš„ä¸¤ä¸ªæ–‡ä»¶ï¼‰ä¼šä¿å­˜ä¸‹æ¥äº†ï¼Œå¦‚æœé€‰hardå°±ç›´æ¥æš´åŠ›åˆ é™¤å•¦</p><p>ä¹‹åè¿è¡Œissue2779æµ‹è¯•ç±»ï¼Œç»ˆäºå‡ºç°äº†æŠ¥é”™ä¿¡æ¯</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/illegal%20jump.png" alt="image-20191211115200184"></p><p>ç„¶åæ‰¾è¿™ç§jdkå’Œè¿™ä¸ªé¡¹ç›®æŠ¥é”™ä¿¡æ¯çš„äº¤ç•Œå¤„</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/more%20error%20info.png" alt="image-20191211115622717"></p><p>ä¹Ÿå°±æ˜¯com.alibaba.fastjson.parser.deserializeråŒ…ä¸‹é¢çš„ASMDeserializerFactoryç±»çš„createJavaBeanDeserializeræ–¹æ³•æœ‰é—®é¢˜</p><h2 id="æŸ¥æ‰¾é—®é¢˜"><a class="header-anchor" href="#æŸ¥æ‰¾é—®é¢˜"></a>æŸ¥æ‰¾é—®é¢˜</h2><p>æˆ‘ä»¬å®šä½åˆ°è¿™ä¸€è¡Œï¼Œè¿›è¡Œæ–­ç‚¹è°ƒè¯•</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/duandiantiaoshi.png" alt="image-20191211115948426"></p><p>æŸ¥çœ‹codeå˜é‡</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/code.png" alt="image-20191202230532915"></p><blockquote><p>codeæ˜¯ä¸€ä¸ªJavaå­—èŠ‚ç </p><p>æ‰€æœ‰çš„.class æ–‡ä»¶çš„å‰å››ä¸ªå­—èŠ‚éƒ½æ˜¯é­”æ•°ï¼Œé­”æ•°çš„å›ºå®šå€¼ä¸ºï¼š0xCAFEBABE</p><p>Javaæœ‰å’–å•¡çš„æ„æ€ï¼Œç¨‹åºå‘˜çš„æµªæ¼«~</p><p>é­”æ•°çš„å›ºå®šå€¼æ˜¯ Java ä¹‹çˆ¶ James Gosling åˆ¶å®šçš„ï¼Œä¸º CafeBabeï¼ˆå’–å•¡å®è´ï¼‰ï¼Œè€Œ Java çš„å›¾æ ‡ä¸ºä¸€æ¯å’–å•¡</p></blockquote><h3 id="evaluate-expressionè¡¨è¾¾å¼æ±‚å€¼"><a class="header-anchor" href="#evaluate-expressionè¡¨è¾¾å¼æ±‚å€¼"></a>Evaluate Expressionè¡¨è¾¾å¼æ±‚å€¼</h3><p>åœ¨codeå¤„å³é”®æœ‰ä¸ªEvaluate Expressionï¼Œè¡¨è¾¾å¼æ±‚å€¼</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/evaluate%20expression.png" alt="image-20191202230841162"></p><p>å°†å­—èŠ‚ç è¾“å‡ºåˆ°æ–‡ä»¶bad.class</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/evaluate-writefile.png" alt="image-20191202231109760"></p><p>å¯ä»¥çœ‹åˆ°é¡¹ç›®è¿™é‡Œå‡ºç°äº†bad.classæ–‡ä»¶</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/badclassloca.png" alt="image-20191211120602606"></p><p>å¾ˆå¥‡æ€ªï¼Œæˆ‘è¿™é‡Œideaå±…ç„¶è¿˜æ˜¯å¯ä»¥åç¼–è¯‘æˆåŠŸ</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/fanbianyibad.png" alt="image-20191211120750776"></p><p>å¦‚æœæ˜¯åçš„ï¼Œideaæ— æ³•åç¼–è¯‘ï¼Œä¼šå‡ºç°ä¸‹é¢çš„ç»“æœï¼Œè§†é¢‘ä¸­æ˜¯è¿™æ ·çš„</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/badclass.png" alt="image-20191202234253689"></p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›å·¥å…·æ¥æŸ¥çœ‹è¿™ä¸ªåçš„å­—èŠ‚ç æ–‡ä»¶</p><p>ä¾‹å¦‚ä¸‹é¢çš„å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javap -v bad #Javaè‡ªå¸¦çš„åç¼–è¯‘å·¥å…·</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¤ªé•¿äº†ï¼Œåœ¨å‘½ä»¤è¡Œçœ‹ä¹Ÿä¸å¤ªæ–¹ä¾¿</p><p>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å·¥å…·classpy</p><h3 id="åç¼–è¯‘å·¥å…·classpy"><a class="header-anchor" href="#åç¼–è¯‘å·¥å…·classpy"></a>åç¼–è¯‘å·¥å…·classpy</h3><p>åœ¨GitHubæœç´¢classpyï¼Œcloneä¸‹æ¥ï¼ŒæŒ‰ç…§readmeå®‰è£…è¿è¡Œ</p><p>æˆ‘æ˜¯Windowsç³»ç»Ÿï¼Œé¦–å…ˆè¿›å…¥classpyç›®å½•ä¸‹ï¼Œç‚¹å‡»è¿è¡Œäº†gradlew.batæ–‡ä»¶ï¼Œç„¶ååœ¨å½“å‰ç›®å½•ä¸‹çš„å‘½ä»¤è¡Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨è¿™ä¸ªå·¥å…·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradle run</span><br></pre></td></tr></table></figure><p>è§†é¢‘ä¸­ä»–çš„Javaç‰ˆæœ¬ä¸º11ï¼Œå¯åŠ¨å¤±è´¥äº†</p><p>ä½¿ç”¨äº†jenvå‘½ä»¤åˆ‡æ¢åˆ°jdk1.8ï¼Œæˆ‘ä½¿ç”¨çš„å°±æ˜¯jdk1.8  å¿½ç•¥è¿™ä¸ªæ­¥éª¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jenv shell 1.8  #éœ€è¦å®‰è£…jenv</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æ‰“å¼€çš„å­—èŠ‚ç æ–‡ä»¶</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/classpybadclass.png" alt="image-20191203001137874"></p><p>ç”±äºæˆ‘ä»¬åªæœ‰Illegal target of jump or branchè¿™ä¸ªæŠ¥é”™ä¿¡æ¯ï¼Œè¿™ä¸€ä¸ªçº¿ç´¢</p><blockquote><p>ä¸‹é¢buildjdkæ“ä½œå¤ªç¡¬æ ¸ï¼Œæˆ‘æ²¡æœ‰è·Ÿç€åšğŸ˜‚  æ„Ÿå…´è¶£å¯ä»¥å»è§†é¢‘16:45å¤„çœ‹çœ‹ğŸ‘</p></blockquote><p>åˆ°jdkä¸­å¯»æ‰¾æ­¤æŠ¥é”™ä¿¡æ¯</p><p>clone openjdkä¸‹çš„jdké¡¹ç›®ï¼Œå…¨å±€æœç´¢æ­¤æŠ¥é”™ä¿¡æ¯Illegal target of jump or branch</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/errorInfoLocaInJDK.png" alt="Illegal target of jump or branch æŠ¥é”™ä¿¡æ¯"></p><p>ç„¶åä»–ä¿®æ”¹äº†jdkï¼Œä¸Šé¢å›¾ç‰‡ä¸­çš„ä»£ç å°±æ˜¯ä¿®æ”¹åçš„jdkï¼ŒåŸæ¥åªæœ‰æŠ¥é”™ä¿¡æ¯ï¼Œä»–è‡ªå·±åŠ ä¸Šäº†jumpå’Œtargetï¼Œå¯ä»¥æç¤ºé”™è¯¯çš„ä½ç½®ï¼Œå¦‚ä¸‹å›¾</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/changeJDK.png" alt="image-20191211131058621"></p><p>ç„¶åä»–è‡ªå·±buildäº†ä¸€ä¸ªjdkğŸ‘</p><p>ä½¿ç”¨è‡ªå·±buildçš„jdké‡æ–°è¿è¡Œissue2779ï¼Œä¸‹é¢æ˜¯æŠ¥é”™ä¿¡æ¯ï¼Œdeserialzeæ–¹æ³•ç¬¬50ä½ç½®</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/errorInJDK.png" alt="image-20191211131737775"></p><p>åœ¨åˆšæ‰classpyæ‰“å¼€çš„bad.classä¸­æ‰¾åˆ°deserialzeæ–¹æ³•  å­—èŠ‚ç   ç¬¬50ä¸ªä½ç½®æ˜¯è¿™æ ·çš„</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/bytecode_50.png" alt="image-20191211124952950"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifeq -32405</span><br></pre></td></tr></table></figure><p>å¯èƒ½æ˜¯æº¢å‡º</p><p>æŸ¥çœ‹ifeqçš„å«ä¹‰ï¼Œå½“æ ˆé¡¶intå‹æ•°å€¼ç­‰äº0æ—¶è·³è½¬</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/ifeq.png" alt="image-20191211132443946"></p><p>fastjsonæœ‰ä¸ªåœ°æ–¹ä»£ç æ²¡æœ‰å†™å¥½ï¼Œç”Ÿæˆäº†ä¸€ä¸ªä¼šæº¢å‡ºçš„è·³è½¬æŒ‡ä»¤</p><p>ç„¶åæ ¹æ®ä¸Šä¸‹æ–‡(50ä½ç½®ä¸Šé¢æœ‰ä¸ªisEnabled)ï¼Œåœ¨æºç ä¸­æ‰¾åˆ°ç›¸åº”ä½ç½®</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/errorloca.png" alt="image-20191211125555537"></p><p>è¿›å…¥visitJumpInsnæ–¹æ³•ï¼Œè¿™å…¶å®æ˜¯asmä»£ç ï¼ˆæ“ä½œå­—èŠ‚ç çš„åº“ï¼‰</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/asmInterf.png" alt="image-20191211133402454"></p><p>æŒ‰crtl+alt+Bå¯ä»¥è¿›å…¥æ¥å£çš„å®ç°ç±»</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/asmImpl.png" alt="image-20191211133434998"></p><h2 id="è§£å†³é—®é¢˜"><a class="header-anchor" href="#è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>ç„¶åä»–è§‰å¾—ï¼Œå¯èƒ½æ˜¯fastjsoné‡Œé¢çš„asmä»£ç ç‰ˆæœ¬å¤ªè€äº†ï¼Œæƒ³æŠŠæœ€æ–°çš„åˆå¹¶è¿›æ¥ï¼Œä½†æ˜¯ç”±äºç‰ˆæœ¬ç›¸å·®7å¹´ï¼Œå¤±è´¥äº†</p><p>å¯¹æ¯”æœ€æ–°çš„asmä»£ç ä¸fastjsoné‡Œé¢çš„ä»£ç </p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/changeCode.png" alt="image-20191211133753383"></p><p>è¿™é‡Œéå¸¸é‡è¦ï¼Œå¦‚æœè¶Šç•Œï¼Œå¯ä»¥å°†IFxxxæ”¹ä¸ºIFNOTxxx  GOTO_W</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/annotation.png" alt="image-20191211175328263"></p><p>æœ€åè§£å†³çš„é—®é¢˜ï¼šæŒ‰ç…§asmçš„è¦æ±‚ï¼ŒæŠŠä¸€ä¸ªä¸æ”¯æŒé•¿è·³è½¬çš„ifeqè½¬å˜æˆifnqåŠ goto_wé•¿è·³è½¬è¯­å¥</p><p><a href="https://github.com/alibaba/fastjson/pull/2858" target="_blank" rel="noopener">pré“¾æ¥</a></p><p>ä¿®å®Œbugä¸€å®šè¦è¡¥ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼</p><h2 id="è§†é¢‘ä¸­æåˆ°å…¶ä»–å†…å®¹"><a class="header-anchor" href="#è§†é¢‘ä¸­æåˆ°å…¶ä»–å†…å®¹"></a>è§†é¢‘ä¸­æåˆ°å…¶ä»–å†…å®¹</h2><h3 id="å­—èŠ‚ç çš„è§£é‡Šï¼š"><a class="header-anchor" href="#å­—èŠ‚ç çš„è§£é‡Šï¼š"></a>å­—èŠ‚ç çš„è§£é‡Šï¼š</h3><p>ç®€å•å†™ä¸€ä¸ªæµ‹è¯•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbcDTO</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i =<span class="number">1</span>,j=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (i+j==<span class="number">3</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"3"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"0"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼Œä½¿ç”¨ASM Bytecode Vieweræ’ä»¶æŸ¥çœ‹å­—èŠ‚ç </p><h3 id="asm-bytecode-vieweræ’ä»¶"><a class="header-anchor" href="#asm-bytecode-vieweræ’ä»¶"></a>ASM Bytecode Vieweræ’ä»¶</h3><p>å¯åœ¨idea Pluginsä¸­å®‰è£…</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/asmplugin.png" alt="image-20191208144452139"></p><p>æ‰¾åˆ°mainæ–¹æ³•</p><p><img src="http://q2cgswswp.bkt.clouddn.com/blog/imgs/JavaBytecode.png" alt="image-20191208144825554"></p><p>æ¯ä¸ªæ–¹æ³•é‡Œé¢æœ‰ä¸ªæ“ä½œæ•°æ ˆï¼Œjvmæ‰§è¡Œæ–¹æ³•æ—¶ä¼šä¸åœçš„æ‰§è¡Œè¿™äº›æŒ‡ä»¤</p><h3 id="ä¿®bugè¦æŒæ¡çš„ä¸œè¥¿"><a class="header-anchor" href="#ä¿®bugè¦æŒæ¡çš„ä¸œè¥¿"></a>ä¿®bugè¦æŒæ¡çš„ä¸œè¥¿</h3><ol><li>èƒ½ä»ç”¨æˆ·æä¾›çš„bugï¼Œé‡ç°bug</li><li>çœ‹æ ˆè½¨è¿¹ï¼Œå­—èŠ‚ç é—®é¢˜å‡ºåœ¨å“ªé‡Œ</li><li>å­¦ä¹ ä½¿ç”¨åç¼–è¯‘å·¥å…·</li><li>é”™è¯¯ä¿¡æ¯åˆ°åº•æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œè¯»jdkæºç ï¼ˆç”šè‡³éœ€è¦build jdkï¼‰</li></ol><p>Rå¤§çš„ä¹¦å•RednaxelaFX</p><p>ä¸‹Â·</p><h3 id="mybatiséœ€è¦æŒæ¡çš„å†…å®¹"><a class="header-anchor" href="#mybatiséœ€è¦æŒæ¡çš„å†…å®¹"></a>mybatiséœ€è¦æŒæ¡çš„å†…å®¹</h3><ol><li>#{} ${}</li><li>ç¼“å­˜æ˜¯å’‹å®ç°çš„ï¼Ÿ</li><li>Executoræ˜¯å•¥ï¼Ÿ</li><li>åˆ†é¡µæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</li></ol><h2 id="æ€»ç»“ä¸€ä¸‹çœ‹è¿™ä¸ªè§†é¢‘äº†è§£åˆ°çš„å†…å®¹"><a class="header-anchor" href="#æ€»ç»“ä¸€ä¸‹çœ‹è¿™ä¸ªè§†é¢‘äº†è§£åˆ°çš„å†…å®¹"></a>æ€»ç»“ä¸€ä¸‹çœ‹è¿™ä¸ªè§†é¢‘äº†è§£åˆ°çš„å†…å®¹</h2><ul><li><p>Javaå­—èŠ‚ç çš„magic number  Cofe Babe</p></li><li><p>ideaçš„è¡¨è¾¾å¼è®¡ç®—Evaluate Expression</p></li><li><p>å­¦ä¹ ä½¿ç”¨åç¼–è¯‘å·¥å…·javap -v ã€classpy</p></li><li><p>ASM Bytecode Vieweræ’ä»¶æŸ¥çœ‹å­—èŠ‚ç </p></li><li><p>è¯è¯´æˆ‘æ‰åˆšçŸ¥é“ideaä¸­å¿«æ·é”®CTRL+Alt+Bå¯ä»¥ä»æ¥å£è·³è½¬åˆ°å®ç°ç±»ğŸ˜‚ç„¶åCtrl+Uæ˜¯å®ç°ç±»åˆ°æ¥å£ğŸ¤£</p></li><li><p>GitHubä¸­çš„issueä»¥åŠpull request</p></li></ul><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> GitHub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ“ä½œç³»ç»Ÿå®éªŒ3 å­˜å‚¨ç®¡ç†</title>
      <link href="/2019/11/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"/>
      <url>/2019/11/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="å®éªŒç›®çš„"><a class="header-anchor" href="#å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h2><p>ç†è§£æ“ä½œç³»ç»Ÿå­˜å‚¨ç®¡ç†åŸç†</p><blockquote><p>æ“ä½œç³»ç»Ÿçš„å‘å±•ä½¿å¾—ç³»ç»Ÿå®Œæˆäº†å¤§éƒ¨åˆ†çš„å†…å­˜ç®¡ç†å·¥ä½œã€‚å¯¹äºç¨‹åºå‘˜è€Œè¨€ï¼Œè¿™äº›å†…å­˜ç®¡ç†çš„è¿‡ç¨‹å®Œå…¨é€æ˜ä¸å¯è§ã€‚å› æ­¤ï¼Œç¨‹åºå‘˜å¼€å‘æ—¶ä»ä¸å…³å¿ƒç³»ç»Ÿå¦‚ä½•ä¸ºè‡ªå·±åˆ†é…å†…å­˜ï¼Œè€Œä¸”æ°¸è¿œè®¤ä¸ºç³»ç»Ÿå¯ä»¥åˆ†é…ç»™ç¨‹åºæ‰€éœ€è¦çš„å†…å­˜ã€‚åœ¨ç¨‹åºå¼€å‘æ—¶ï¼Œç¨‹åºå‘˜çœŸæ­£éœ€è¦åšçš„å°±æ˜¯ï¼šç”³è¯·å†…å­˜ã€ä½¿ç”¨å†…å­˜ã€é‡Šæ”¾å†…å­˜ï¼Œå…¶ä»–ä¸€æ¦‚æ— éœ€è¿‡é—®ã€‚</p></blockquote><a id="more"></a><h2 id="å®éªŒå†…å®¹"><a class="header-anchor" href="#å®éªŒå†…å®¹"></a>å®éªŒå†…å®¹</h2><h3 id="ç¨‹åº1"><a class="header-anchor" href="#ç¨‹åº1"></a>ç¨‹åº1</h3><p>ç”³è¯·å†…å­˜ã€ä½¿ç”¨å†…å­˜ä»¥åŠé‡Šæ”¾ä¸€å—å†…å­˜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//B17040417.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> * str;</span><br><span class="line"><span class="keyword">if</span> ((str=(<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">10</span>))==<span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"not enough memory to allocate buffer\\n"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">strcpy</span>(str,<span class="string">"hello"</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"string is %s\n"</span>,str);</span><br><span class="line"><span class="built_in">free</span>(str);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¨‹åº2"><a class="header-anchor" href="#ç¨‹åº2"></a>ç¨‹åº2</h3><p>åœ¨æ‰“å¼€æ–‡ä»¶åï¼Œé€šè¿‡fstat()è·å¾—æ–‡ä»¶é•¿åº¦ï¼Œç„¶åé€šè¿‡malloc()ç³»ç»Ÿè°ƒç”¨ç”³è¯·å“åº”å¤§å°çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡read()å°†æ–‡ä»¶å†…å®¹å®Œå…¨è¯»å…¥è¯¥å†…å­˜ç©ºé—´ï¼Œå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//yanglonglong.c(è·¯å¾„: /opt/yanglonglong.c)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line">main()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> fd,len;</span><br><span class="line">  <span class="keyword">void</span> *tp;<span class="comment">//void *åˆ™ä¸ºâ€œæ— ç±»å‹æŒ‡é’ˆâ€ï¼Œå¯ä»¥æŒ‡å‘ä»»ä½•æ•°æ®ç±»å‹</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">ps</span>;</span></span><br><span class="line">  fd=<span class="built_in">open</span>(<span class="string">"/opt/yanglonglong.c"</span>,<span class="number">0</span>);</span><br><span class="line">  fstat(fd,&amp;ps);</span><br><span class="line">  len=ps.st_size;</span><br><span class="line">  tp=<span class="built_in">malloc</span>(len);</span><br><span class="line">  <span class="built_in">read</span>(fd,tp,len);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,tp);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"size:%d bytes\n"</span>,len);</span><br><span class="line">  <span class="built_in">close</span>(fd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çŸ¥è¯†ç‚¹"><a class="header-anchor" href="#çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><h3 id="å®éªŒæŒ‡å¯¼å†…å®¹"><a class="header-anchor" href="#å®éªŒæŒ‡å¯¼å†…å®¹"></a>å®éªŒæŒ‡å¯¼å†…å®¹</h3><h4 id="1-å†…å­˜åŠ¨æ€åˆ†é…å‡½æ•°"><a class="header-anchor" href="#1-å†…å­˜åŠ¨æ€åˆ†é…å‡½æ•°"></a>1ï¼‰å†…å­˜åŠ¨æ€åˆ†é…å‡½æ•°</h4><p>#include &lt;malloc.h&gt;</p><p>void *malloc(size_t size)</p><p>è¯¥å‡½æ•°åˆ†é…æŒ‡å®šå¤§å°sizeä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼ŒæˆåŠŸæ—¶è¿”å›åˆ†é…å†…å­˜çš„æŒ‡é’ˆï¼ˆå³æ‰€åˆ†é…å†…å­˜çš„åœ°å€ï¼‰ã€‚è¯¥å†…å­˜åŒºåŸŸæ²¡æœ‰æ¸…ç©ºã€‚</p><h4 id="2-void-free-void-addr"><a class="header-anchor" href="#2-void-free-void-addr"></a>2ï¼‰ void free(void * addr);</h4><p>è¯¥å‡½æ•°é‡Šæ”¾ç”±malloc()åˆ†é…çš„å†…å­˜ï¼Œaddræ˜¯è¦é‡Šæ”¾å†…å­˜ç©ºé—´çš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”addrå¿…é¡»æ˜¯è¢«ä»¥å‰malloc( )è°ƒç”¨è¿”å›çš„ã€‚</p><h3 id="ç½‘ä¸ŠæŸ¥é˜…å†…å®¹"><a class="header-anchor" href="#ç½‘ä¸ŠæŸ¥é˜…å†…å®¹"></a>ç½‘ä¸ŠæŸ¥é˜…å†…å®¹</h3><h4 id="mallocçš„ä½¿ç”¨æ–¹æ³•åŠæ³¨æ„äº‹é¡¹"><a class="header-anchor" href="#mallocçš„ä½¿ç”¨æ–¹æ³•åŠæ³¨æ„äº‹é¡¹"></a>mallocçš„ä½¿ç”¨æ–¹æ³•åŠæ³¨æ„äº‹é¡¹</h4><p>ä½¿ç”¨Cè¯­è¨€è¿›è¡Œå¼€å‘çš„æ—¶å€™,å†…å­˜ç®¡ç†éå¸¸é‡è¦,å¦‚æœå†…å­˜ç®¡ç†ä¸å½“,ä¼šå¯¼è‡´å†…å­˜æ³„éœ²,ç¨‹åºæ— æ•…æ­»æœº,<br>åœ¨Cè¯­è¨€ä¸­å†…å­˜ç®¡ç†ä¸­,éœ€è¦ä½¿ç”¨malloc()å’Œfree()ä¸¤ä¸ªå‡½æ•°</p><h5 id="1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨mallocå’Œfree"><a class="header-anchor" href="#1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨mallocå’Œfree"></a>1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨mallocå’Œfree ?</h5><p>ä½¿ç”¨malloc,freeå¯ä»¥åŠ¨æ€çš„åˆ†é…å†…å­˜å’ŒåŠ¨æ€é‡Šæ”¾å†…å­˜,èŠ‚çº¦åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶,æ‰€å ç”¨çš„å†…å­˜ç©ºé—´,ä»¥ä¸Šä¹Ÿæ˜¯mallocçš„ä¼˜ç‚¹ã€‚</p><h5 id="2-mallocå’ŒæŒ‡é’ˆçš„å…³ç³»"><a class="header-anchor" href="#2-mallocå’ŒæŒ‡é’ˆçš„å…³ç³»"></a>2 mallocå’ŒæŒ‡é’ˆçš„å…³ç³»?</h5><p>void p= *malloc(long num)ï¼šè¯¥å‡½æ•°åˆ†é…äº†numä¸ªå­—èŠ‚,å¹¶è¿”å›äº†æŒ‡å‘è¿™å—å†…å­˜çš„æŒ‡é’ˆã€‚å¦‚æœåˆ†é…å¤±è´¥ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæŒ‡é’ˆï¼ˆNULLï¼‰ã€‚<br>å…³äºåˆ†é…å¤±è´¥çš„åŸå› ï¼Œåº”è¯¥æœ‰å¤šç§ï¼Œæ¯”å¦‚è¯´ç©ºé—´ä¸è¶³å°±æ˜¯ä¸€ç§ã€‚<br>void freeÂ§ï¼š è¯¥å‡½æ•°æ˜¯å°†ä¹‹å‰ç”¨mallocåˆ†é…çš„ç©ºé—´è¿˜ç»™ç¨‹åºæˆ–è€…æ˜¯æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯é‡Šæ”¾äº†è¿™å—å†…å­˜,è®©è¿™å—å†…å­˜é‡æ–°äº¤ç»™æ“ä½œç³»ç»Ÿç®¡ç†ã€‚<br>ç»¼ä¸Šæ‰€è¿°ï¼šå› ä¸ºmallocåˆ†é…æˆåŠŸåè¿”å›å†…å­˜çš„é¦–åœ°å€ï¼Œåœ¨ä½¿ç”¨ä¸­æ˜¯æŒ‰åœ°å€æ¥è¿›è¡Œè°ƒç”¨ï¼Œæ‰€ä»¥æœ‰mallocåˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œå°±æœ‰æŒ‡é’ˆå­˜åœ¨ã€‚</p><h5 id="3-ä¸€èˆ¬ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°malloc"><a class="header-anchor" href="#3-ä¸€èˆ¬ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°malloc"></a>3 ä¸€èˆ¬ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°malloc ?</h5><p>åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œå¯å˜çš„array,structå¯ä»¥ç”¨åˆ°mallocåˆ†é…å†…å­˜ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨åˆ†é…ä¸€ä¸ªè¿ç»­çš„ç©ºé—´ å­˜å‚¨ä¸€æ‰¹ç›¸åŒç±»å‹çš„å˜é‡ã€‚</p><h5 id="4-mallocçš„ç”¨æ³•"><a class="header-anchor" href="#4-mallocçš„ç”¨æ³•"></a>4 mallocçš„ç”¨æ³•</h5><p>ç¨‹åºä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *p = <span class="literal">NULL</span>;</span><br><span class="line">p= (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">100</span> * <span class="keyword">sizeof</span>(<span class="keyword">char</span>)); <span class="comment">//åˆ†é…100ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> == p) <span class="comment">//æ£€æµ‹mallocæ˜¯å¦åˆ†é…æˆåŠŸ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">exit</span> (<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨åˆ†é…ç©ºé—´</span></span><br><span class="line"><span class="built_in">free</span>(p); <span class="comment">//é‡Šæ”¾ç©ºé—´</span></span><br><span class="line">p= <span class="literal">NULL</span>; <span class="comment">//æŒ‡é’ˆé‡Šæ”¾</span></span><br></pre></td></tr></table></figure><h5 id="5-mallocä½¿ç”¨æ³¨æ„äº‹é¡¹"><a class="header-anchor" href="#5-mallocä½¿ç”¨æ³¨æ„äº‹é¡¹"></a>5 mallocä½¿ç”¨æ³¨æ„äº‹é¡¹</h5><ol><li>mallocå†…å­˜ç©ºé—´å,éœ€è¦æ£€æŸ¥æ˜¯å¦åˆ†é…æˆåŠŸ!</li><li>ä½¿ç”¨å®Œæ¯•åéœ€è¦é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œé‡Šæ”¾ååº”è¯¥æŠŠæŒ‡å‘è¿™å—å†…å­˜çš„æŒ‡é’ˆæŒ‡å‘NULL,é¿å…å†æ¬¡ä½¿ç”¨æ—¶ï¼Œå‡ºç°å¥‡æ€ªçš„é”™è¯¯ç°è±¡ã€‚</li><li>mallocå†…å­˜åï¼Œä¸é‡Šæ”¾ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²ï¼Œå¤šæ¬¡ä½¿ç”¨freeé‡Šæ”¾ä¼šå¯¼è‡´ç¨‹åºæŠ¥é”™ã€‚</li><li>mallocå†…å­˜æ—¶å€™ï¼Œéœ€è¦å¯¹è¿”å›çš„æŒ‡é’ˆç±»å‹åšå¼ºåˆ¶è½¬æ¢ã€‚</li></ol><h4 id="readå‡½æ•°"><a class="header-anchor" href="#readå‡½æ•°"></a>readå‡½æ•°</h4><p>ç”¨readå‡½æ•°è¯»å–æ•°ç»„ä¸­çš„å…ƒç´ ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> buf[<span class="number">200</span>];</span><br><span class="line"><span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°è¯´æ˜çš„æ˜¯ä»0å¼€å§‹è¯»å–<br>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ï¼šè¦è¯»å–çš„æ•°ç»„buf<br>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ï¼šè¦è¯»5ä¸ª</p><p>æ€»ç»“ï¼šä»ç¬¬0ä¸ªå¼€å§‹è¯»å–bufä¸­çš„5ä¸ªå…ƒç´ ï¼ˆè¿ç»­çš„ï¼‰</p><h4 id="fstat"><a class="header-anchor" href="#fstat"></a>fstat</h4><p>åŠŸèƒ½ï¼š<br>è·å¾—æ–‡ä»¶æˆ–å…±äº«å†…å­˜åŒºçš„ä¿¡æ¯<br>å¤´æ–‡ä»¶ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntk.h&gt;</span></span></span><br></pre></td></tr></table></figure><p>å‡½æ•°åŸå½¢ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">stat</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *file_name,struct stat *buf)</span></span>;</span><br></pre></td></tr></table></figure><p>å‚æ•°ï¼š<br>file_name          æ–‡ä»¶å<br>buf                     statç»“æ„<br>è¿”å›å€¼ï¼š<br>æˆåŠŸè¿”å›0ï¼Œå‡ºé”™è¿”å›-1<br>å¯¹äºæ™®é€šæ–‡ä»¶statç»“æ„å¯ä»¥è·å¾—12ä¸ªä»¥ä¸Šçš„æˆå‘˜ä¿¡æ¯ï¼Œç„¶è€Œå½“fdæŒ‡ä»£ä¸€ä¸ªå…±äº«å†…å­˜åŒºå¯¹è±¡æ—¶ï¼Œåªæœ‰å››ä¸ªæˆå‘˜å«æœ‰ä¿¡æ¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stat</span>&#123;</span></span><br><span class="line"><span class="keyword">mode_t</span> st_mode;</span><br><span class="line"><span class="keyword">uid_t</span> st_uid;</span><br><span class="line"><span class="keyword">gid_t</span> st_gid;</span><br><span class="line"><span class="keyword">off_t</span> st_size;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="exit-å‡½æ•°"><a class="header-anchor" href="#exit-å‡½æ•°"></a>exit()å‡½æ•°:</h4><p>æ‰€åœ¨å¤´æ–‡ä»¶ï¼š<strong>stdlib.h</strong><br>åŠŸ èƒ½: å…³é—­æ‰€æœ‰æ–‡ä»¶ï¼Œç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ã€‚<br>exit(1)è¡¨ç¤ºå¼‚å¸¸é€€å‡º.è¿™ä¸ª1æ˜¯è¿”å›ç»™æ“ä½œç³»ç»Ÿçš„ã€‚<br>exit(x)ï¼ˆxä¸ä¸º0ï¼‰éƒ½è¡¨ç¤ºå¼‚å¸¸é€€å‡º<br>exit(0)è¡¨ç¤ºæ­£å¸¸é€€å‡º<br>exit()çš„å‚æ•°ä¼šè¢«ä¼ é€’ç»™ä¸€äº›æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬UNIX,Linux,å’ŒMS DOSï¼Œä»¥ä¾›å…¶ä»–ç¨‹åºä½¿ç”¨ã€‚<br><strong>stdlib.h</strong>: void exit(int status);<br>å‚ æ•° : status //ç¨‹åºé€€å‡ºçš„è¿”å›å€¼.</p><h4 id="exitå‡½æ•°å’Œreturnå‡½æ•°çš„ä¸»è¦åŒºåˆ«ï¼š"><a class="header-anchor" href="#exitå‡½æ•°å’Œreturnå‡½æ•°çš„ä¸»è¦åŒºåˆ«ï¼š"></a>exitå‡½æ•°å’Œreturnå‡½æ•°çš„ä¸»è¦åŒºåˆ«ï¼š</h4><p>1ï¼‰exitç”¨äºåœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­éšæ—¶ç»“æŸç¨‹åºï¼Œexitçš„å‚æ•°æ˜¯è¿”å›ç»™OSçš„ã€‚mainå‡½æ•°ç»“æŸæ—¶ä¹Ÿä¼šéšå¼åœ°è°ƒç”¨exitå‡½æ•°ã€‚exitå‡½æ•°è¿è¡Œæ—¶é¦–å…ˆä¼šæ‰§è¡Œç”±atexit()å‡½æ•°ç™»è®°çš„å‡½æ•°ï¼Œç„¶åä¼šåšä¸€äº›è‡ªèº«çš„æ¸…ç†å·¥ä½œï¼ŒåŒæ—¶åˆ·æ–°æ‰€æœ‰è¾“å‡ºæµã€å…³é—­æ‰€æœ‰æ‰“å¼€çš„æµå¹¶ä¸”å…³é—­é€šè¿‡æ ‡å‡†I/Oå‡½æ•°tmpfile()åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶ã€‚exitæ˜¯ç»“æŸä¸€ä¸ªè¿›ç¨‹ï¼Œå®ƒå°†åˆ é™¤è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ç©ºé—´ï¼ŒåŒæ—¶æŠŠé”™è¯¯ä¿¡æ¯è¿”å›çˆ¶è¿›ç¨‹,è€Œreturnæ˜¯è¿”å›å‡½æ•°å€¼å¹¶é€€å‡ºå‡½æ•°ã€‚é€šå¸¸æƒ…å†µï¼š</p><ul><li><p>exit(0)è¡¨ç¤ºç¨‹åºæ­£å¸¸,</p></li><li><p>exit(1)å’Œexit(-1)è¡¨ç¤ºç¨‹åºå¼‚å¸¸é€€å‡ºï¼Œexit(2)è¡¨ç¤ºè¡¨ç¤ºç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚</p></li></ul><p>åœ¨æ•´ä¸ªç¨‹åºä¸­ï¼Œåªè¦è°ƒç”¨exitå°±ç»“æŸï¼ˆå½“å‰è¿›ç¨‹æˆ–è€…åœ¨mainæ—¶å€™ä¸ºæ•´ä¸ªç¨‹åºï¼‰ã€‚</p><p>2ï¼‰returnæ˜¯è¯­è¨€çº§åˆ«çš„ï¼Œå®ƒè¡¨ç¤ºäº†è°ƒç”¨å †æ ˆçš„è¿”å›ï¼›return( )æ˜¯å½“å‰å‡½æ•°è¿”å›ï¼Œå½“ç„¶å¦‚æœæ˜¯åœ¨ä¸»å‡½æ•°main, è‡ªç„¶ä¹Ÿå°±ç»“æŸå½“å‰è¿›ç¨‹äº†ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£å°±æ˜¯é€€å›ä¸Šä¸€å±‚è°ƒç”¨ã€‚åœ¨å¤šä¸ªè¿›ç¨‹æ—¶ã€‚å¦‚æœæœ‰æ—¶è¦æ£€æµ‹ä¸Šä¸ªè¿›ç¨‹æ˜¯å¦æ­£å¸¸é€€å‡ºã€‚å°±è¦ç”¨åˆ°ä¸Šä¸ªè¿›ç¨‹çš„è¿”å›å€¼ï¼Œä¾æ¬¡ç±»æ¨ã€‚è€Œexitæ˜¯ç³»ç»Ÿè°ƒç”¨çº§åˆ«çš„ï¼Œå®ƒè¡¨ç¤ºäº†ä¸€ä¸ªè¿›ç¨‹çš„ç»“æŸã€‚</p><p>3ï¼‰exitå‡½æ•°æ˜¯é€€å‡ºåº”ç”¨ç¨‹åºï¼Œå¹¶å°†åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªçŠ¶æ€è¿”å›ç»™OSï¼Œè¿™ä¸ªçŠ¶æ€æ ‡è¯†äº†åº”ç”¨ç¨‹åºçš„ä¸€äº›è¿è¡Œä¿¡æ¯ã€‚</p><p>4ï¼‰å’Œæœºå™¨å’Œæ“ä½œç³»ç»Ÿæœ‰å…³çš„ä¸€èˆ¬æ˜¯ï¼š 0ä¸ºæ­£å¸¸é€€å‡ºï¼Œé0ä¸ºéæ­£å¸¸é€€å‡ºï¼›</p><h4 id="è¿›ç¨‹ç¯å¢ƒä¸è¿›ç¨‹æ§åˆ¶"><a class="header-anchor" href="#è¿›ç¨‹ç¯å¢ƒä¸è¿›ç¨‹æ§åˆ¶"></a>è¿›ç¨‹ç¯å¢ƒä¸è¿›ç¨‹æ§åˆ¶</h4><p>â€‹exit(int n)å…¶å®å°±æ˜¯ç›´æ¥é€€å‡ºç¨‹åºï¼Œå› ä¸ºé»˜è®¤çš„æ ‡å‡†ç¨‹åºå…¥å£ä¸º int main(int argc, char** argv)ï¼Œè¿”å›å€¼æ˜¯intå‹çš„ã€‚ä¸€èˆ¬åœ¨shellä¸‹é¢ï¼Œè¿è¡Œä¸€ä¸ªç¨‹åºï¼Œç„¶åä½¿ç”¨å‘½ä»¤echo $?å°±èƒ½å¾—åˆ°è¯¥ç¨‹åºçš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯é€€å‡ºå€¼ï¼Œåœ¨main()é‡Œé¢ï¼Œä½ å¯ä»¥ç”¨return nï¼Œä¹Ÿèƒ½å¤Ÿç›´æ¥ç”¨exit(n)æ¥åšã€‚unixé»˜è®¤çš„æ­£ç¡®é€€å‡ºæ˜¯è¿”å›0ï¼Œé”™è¯¯è¿”å›é0ã€‚</p><p>ç†è®ºä¸Šexitå¯ä»¥è¿”å›å°äº256çš„ä»»ä½•æ•´æ•°ã€‚è¿”å›çš„ä¸åŒæ•°å€¼ä¸»è¦æ˜¯ç»™è°ƒç”¨è€…ä½œä¸åŒå¤„ç†çš„ã€‚</p><p>å•ç‹¬çš„è¿›ç¨‹æ˜¯è¿”å›ç»™æ“ä½œç³»ç»Ÿçš„ã€‚å¦‚æœæ˜¯å¤šè¿›ç¨‹ï¼Œæ˜¯è¿”å›ç»™çˆ¶è¿›ç¨‹çš„ã€‚çˆ¶è¿›ç¨‹é‡Œé¢è°ƒç”¨waitpid()ç­‰å‡½æ•°å¾—åˆ°å­è¿›ç¨‹é€€å‡ºçš„çŠ¶æ€ï¼Œä»¥ä¾¿ä½œä¸åŒå¤„ç†ã€‚æ ¹æ®ç›¸åº”çš„è¿”å›å€¼æ¥è®©è°ƒç”¨è€…ä½œå‡ºç›¸åº”çš„å¤„ç†.æ€»çš„è¯´æ¥ï¼Œexitï¼ˆï¼‰å°±æ˜¯å½“å‰è¿›ç¨‹æŠŠæ§åˆ¶æƒè¿”å›ç»™è°ƒç”¨è¯¥ç¨‹åºçš„ç¨‹åº,æ‹¬å·é‡Œçš„æ˜¯è¿”å›å€¼,å‘Šè¯‰è°ƒç”¨ç¨‹åºè¯¥ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ã€‚</p><h5 id="1-è¿›ç¨‹çš„å¼€å§‹ï¼š"><a class="header-anchor" href="#1-è¿›ç¨‹çš„å¼€å§‹ï¼š"></a>1ï¼‰ è¿›ç¨‹çš„å¼€å§‹ï¼š</h5><p>Cç¨‹åºæ˜¯ä»mainå‡½æ•°å¼€å§‹æ‰§è¡Œ, åŸå‹å¦‚ä¸‹:int main(int argc, char *argv[]);é€šå¸¸mainçš„è¿”å›å€¼æ˜¯intå‹, æ­£ç¡®è¿”å›0ã€‚å¦‚æœmainçš„è¿”å›å€¼ä¸ºvoid, æŸäº›ç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Š, æ­¤æ—¶mainçš„è¿”å›å€¼é€šå¸¸æ˜¯0ã€‚</p><h5 id="2-è¿›ç¨‹ç»ˆæ­¢ï¼š"><a class="header-anchor" href="#2-è¿›ç¨‹ç»ˆæ­¢ï¼š"></a>2ï¼‰è¿›ç¨‹ç»ˆæ­¢ï¼š</h5><p>Cç¨‹åºçš„ç»ˆæ­¢åˆ†ä¸ºä¸¤ç§: æ­£å¸¸ç»ˆæ­¢å’Œå¼‚å¸¸ç»ˆæ­¢ã€‚æ­£å¸¸ç»ˆæ­¢åˆ†ä¸º: return, exit, _exit, _Exit, pthreade_exitã€‚å¼‚å¸¸ä¸­æŒ‡åˆ†ä¸º: abort, SIGNAL, çº¿ç¨‹å“åº”å–æ¶ˆã€‚<br>ä¸»è¦è¯´ä¸€ä¸‹æ­£å¸¸ç»ˆæ­¢çš„å‰4ç§, å³exitç³»åˆ—å‡½æ•°.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;   </span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exit</span><span class="params">(<span class="keyword">int</span> status)</span></span>;</span><br><span class="line"><span class="keyword">void</span> _Exit(<span class="keyword">int</span> status);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;   </span></span></span><br><span class="line"><span class="keyword">void</span> _exit(<span class="keyword">int</span> status);</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š3ä¸ªå‡½æ•°çš„åŒºåˆ«æ˜¯:exit()(æˆ–return 0)ä¼šè°ƒç”¨ç»ˆæ­¢å¤„ç†ç¨‹åºå’Œç”¨æˆ·ç©ºé—´çš„æ ‡å‡†I/Oæ¸…ç†ç¨‹åº(å¦‚fclose), <em>exitå’Œ</em> Exitä¸è°ƒç”¨è€Œç›´æ¥ç”±å†…æ ¸æ¥ç®¡è¿›è¡Œæ¸…ç†ã€‚<strong>å› æ­¤, åœ¨mainå‡½æ•°ä¸­exit(0)ç­‰ä»·äºreturn 0</strong></p><h5 id="3-atexitç»ˆæ­¢å¤„ç†ç¨‹åºï¼š"><a class="header-anchor" href="#3-atexitç»ˆæ­¢å¤„ç†ç¨‹åºï¼š"></a>3ï¼‰ atexitç»ˆæ­¢å¤„ç†ç¨‹åºï¼š</h5><p>ISO Cè§„å®š, ä¸€ä¸ªè¿›ç¨‹æœ€å¤šå¯ç™»è®°32ä¸ªç»ˆæ­¢å¤„ç†å‡½æ•°, è¿™äº›å‡½æ•°ç”±exitæŒ‰ç™»è®°ç›¸åçš„é¡ºåºè‡ªåŠ¨è°ƒç”¨ã€‚å¦‚æœåŒä¸€å‡½æ•°ç™»è®°å¤šæ¬¡, ä¹Ÿä¼šè¢«è°ƒç”¨å¤šæ¬¡ã€‚<br>åŸå‹å¦‚ä¸‹:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">atexit</span><span class="params">(<span class="keyword">void</span> (*func)(<span class="keyword">void</span>))</span></span>;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ, æŒ‡å‘ç»ˆæ­¢å¤„ç†å‡½æ•°, è¯¥å‡½æ•°æ— å‚æ— è¿”å›å€¼ã€‚atexitå‡½æ•°æœ¬èº«æˆåŠŸè°ƒç”¨åè¿”å›0ã€‚</p><p>ä»¥ä¸‹é¢çš„ç¨‹åºä¸ºä¾‹:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">myexit1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"first exit handler\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">myexit2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"second exit handler\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    atexit(my_exit2)ï¼›</span><br><span class="line">  atexit(my_exit1)ï¼› </span><br><span class="line"></span><br><span class="line">atexit(my_exit1)ï¼›</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"main is done\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ .&#x2F;a.out</span><br><span class="line">main is done</span><br><span class="line">first exit handler</span><br><span class="line">first exit handler</span><br><span class="line">second exit handler</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢çš„ç»“æœï¼Œå¯ä»¥å‘ç°è¿™äº›å‡½æ•°ç”±exitæŒ‰ç™»è®°ç›¸åçš„é¡ºåºè‡ªåŠ¨è°ƒç”¨ï¼ˆå…ˆmyexit1åmyexit2ï¼‰ã€‚å¦‚æœåŒä¸€å‡½æ•°ç™»è®°å¤šæ¬¡, ä¹Ÿä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼ˆå¦‚è¿™é‡Œçš„myexit1ï¼‰ã€‚è€Œè¿™äº›å¤„ç†å‡½æ•°éƒ½æ˜¯åœ¨ç¨‹åºé€€å‡ºçš„æ—¶å€™åˆ©ç”¨atexitå‡½æ•°è°ƒç”¨äº†è¿™äº›å¤„ç†å‡½æ•°ã€‚ä½†æ˜¯å¦‚æœç”¨_exit()é€€å‡ºç¨‹åºï¼Œåˆ™å®ƒä¸å…³é—­ä»»ä½•æ–‡ä»¶ï¼Œä¸æ¸…é™¤ä»»ä½•ç¼“å†²å™¨ã€ä¹Ÿä¸è°ƒç”¨ä»»ä½•ç»ˆæ­¢å‡½æ•°ï¼</p><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      <categories>
          
          <category> å®éªŒæŠ¥å‘Š </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºå›¾å½¢å­¦å¤ä¹ </title>
      <link href="/2019/10/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%A4%8D%E4%B9%A0/"/>
      <url>/2019/10/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%A4%8D%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><a href="https://learnopengl-cn.readthedocs.io/zh/latest/" target="_blank" rel="noopener">OpenGLå®˜æ–¹æ–‡æ¡£é“¾æ¥</a></p><blockquote><p>æ­¤åšå®¢ç”¨æ¥å­¦ä¹ OpenGLçŸ¥è¯†ä»¥åŠç›¸å…³å‡½æ•°çš„å­¦ä¹ ï¼Œä¸åŒ…å«å®Œæ•´é¡¹ç›®çš„æºç </p></blockquote><a id="more"></a><h2 id="èµ·æ­¥"><a class="header-anchor" href="#èµ·æ­¥"></a>èµ·æ­¥</h2><p>å¼€å‘ç¯å¢ƒvs2017</p><p>GLFWæ˜¯ä¸€ä¸ªä¸“é—¨é’ˆå¯¹OpenGLçš„Cè¯­è¨€åº“ï¼Œå®ƒæä¾›äº†ä¸€äº›æ¸²æŸ“ç‰©ä½“æ‰€éœ€çš„æœ€ä½é™åº¦çš„æ¥å£ã€‚</p><p>OpenGLåªæ˜¯ä¸€ä¸ªæ ‡å‡†/è§„èŒƒï¼Œå…·ä½“çš„å®ç°æ˜¯ç”±é©±åŠ¨å¼€å‘å•†é’ˆå¯¹ç‰¹å®šæ˜¾å¡å®ç°çš„ã€‚ç”±äºOpenGLé©±åŠ¨ç‰ˆæœ¬ä¼—å¤šï¼Œå®ƒå¤§å¤šæ•°å‡½æ•°çš„ä½ç½®éƒ½æ— æ³•åœ¨ç¼–è¯‘æ—¶ç¡®å®šä¸‹æ¥ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶æŸ¥è¯¢ã€‚ä»»åŠ¡å°±è½åœ¨äº†å¼€å‘è€…èº«ä¸Šï¼Œå¼€å‘è€…éœ€è¦åœ¨è¿è¡Œæ—¶è·å–å‡½æ•°åœ°å€å¹¶å°†å…¶ä¿å­˜åœ¨ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆä¸­ä¾›ä»¥åä½¿ç”¨ã€‚å–å¾—åœ°å€çš„æ–¹æ³•å› å¹³å°è€Œå¼‚ï¼Œåœ¨Windowsä¸Šä¼šæ˜¯ç±»ä¼¼è¿™æ ·ï¼š</p><p>äº†è§£å³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰å‡½æ•°åŸå‹</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*GL_GENBUFFERS)</span> <span class="params">(GLsizei, GLuint*)</span></span>;</span><br><span class="line"><span class="comment">// æ‰¾åˆ°æ­£ç¡®çš„å‡½æ•°å¹¶èµ‹å€¼ç»™å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">GL_GENBUFFERS glGenBuffers  = (GL_GENBUFFERS)wglGetProcAddress(<span class="string">"glGenBuffers"</span>);</span><br><span class="line"><span class="comment">// ç°åœ¨å‡½æ•°å¯ä»¥è¢«æ­£å¸¸è°ƒç”¨äº†</span></span><br><span class="line">GLuint <span class="built_in">buffer</span>;</span><br><span class="line">glGenBuffers(<span class="number">1</span>, &amp;<span class="built_in">buffer</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»£ç éå¸¸å¤æ‚ï¼Œè€Œä¸”å¾ˆç¹çï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå¯èƒ½ä½¿ç”¨çš„å‡½æ•°éƒ½è¦é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰äº›åº“èƒ½ç®€åŒ–æ­¤è¿‡ç¨‹ï¼Œå…¶ä¸­<strong>GLEW</strong>æ˜¯ç›®å‰æœ€æ–°ï¼Œä¹Ÿæ˜¯æœ€æµè¡Œçš„åº“ã€‚</p><p>GLEWæ˜¯OpenGL Extension Wrangler Libraryçš„ç¼©å†™ï¼Œå®ƒèƒ½è§£å†³æˆ‘ä»¬ä¸Šé¢æåˆ°çš„é‚£ä¸ªç¹ççš„é—®é¢˜ã€‚å› ä¸ºGLEWä¹Ÿæ˜¯ä¸€ä¸ªåº“ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦æ„å»ºå¹¶å°†å…¶é“¾æ¥è¿›å·¥ç¨‹ã€‚</p><h3 id="é™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥"><a class="header-anchor" href="#é™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥"></a>é™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥</h3><p><strong>é™æ€</strong>(Static)é“¾æ¥æ˜¯æŒ‡ç¼–è¯‘æ—¶å°±å°†åº“ä»£ç é‡Œçš„å†…å®¹æ•´åˆè¿›ä½ çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä¼˜ç‚¹å°±æ˜¯ä½ ä¸éœ€è¦ç®¡ç†é¢å¤–çš„æ–‡ä»¶äº†ï¼Œåªéœ€è¦å‘å¸ƒä½ å•ç‹¬çš„ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å°±è¡Œäº†ã€‚ç¼ºç‚¹å°±æ˜¯ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶ä¼šå˜å¾—æ›´å¤§ï¼Œå¦å¤–å½“åº“æœ‰å‡çº§ç‰ˆæœ¬æ—¶ï¼Œä½ å¿…é¡»é‡æ–°è¿›è¡Œç¼–è¯‘æ•´ä¸ªç¨‹åºã€‚</p><p><strong>åŠ¨æ€</strong>(Dynamic)é“¾æ¥æ˜¯æŒ‡ä¸€ä¸ªåº“é€šè¿‡<code>.dll</code>æˆ–<code>.so</code>çš„æ–¹å¼å­˜åœ¨ï¼Œå®ƒçš„ä»£ç ä¸ä½ çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„ä»£ç æ˜¯åˆ†ç¦»çš„ã€‚ä¼˜ç‚¹æ˜¯ä½¿ä½ çš„äºŒè¿›åˆ¶æ–‡ä»¶å¤§å°å˜å°å¹¶ä¸”æ›´å®¹æ˜“å‡çº§ï¼Œç¼ºç‚¹æ˜¯ä½ æœ€ç»ˆå‘å¸ƒç¨‹åºæ—¶å¿…é¡»å¸¦ä¸Šè¿™äº›DLLã€‚</p><p>é™æ€é“¾æ¥GLEWï¼Œå¿…é¡»åœ¨åŒ…å«GLEWå¤´æ–‡ä»¶ä¹‹å‰å®šä¹‰é¢„å¤„ç†å™¨å®<code>GLEW_STATIC</code>ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GLEW_STATIC</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GL/glew.h&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºçª—å£"><a class="header-anchor" href="#åˆ›å»ºçª—å£"></a>åˆ›å»ºçª—å£</h2><p>ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="comment">//GLEW</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GLEW_STATIC</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GL/glew.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//GLFW</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GLFW/glfw3.h&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> GLint WIDTH = <span class="number">800</span>, HEIGHT = <span class="number">600</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">glfwInit();<span class="comment">//åˆå§‹åŒ–glfw</span></span><br><span class="line">glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, <span class="number">3</span>);<span class="comment">//é…ç½®GLFW</span></span><br><span class="line">glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, <span class="number">3</span>);<span class="comment">//é…ç½®GLFW</span></span><br><span class="line">glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);</span><br><span class="line">glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE); <span class="comment">// must for Mac</span></span><br><span class="line">glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//glfwCreateWindowå‡½æ•°éœ€è¦çª—å£çš„å®½å’Œé«˜ä½œä¸ºå®ƒçš„å‰ä¸¤ä¸ªå‚æ•°ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºè¿™ä¸ªçª—å£çš„åç§°ï¼ˆæ ‡é¢˜ï¼‰ï¼›æœ€åä¸¤ä¸ªå‚æ•°æˆ‘ä»¬æš‚æ—¶å¿½ç•¥ï¼Œå…ˆè®¾ç½®ä¸ºç©ºæŒ‡é’ˆå°±è¡Œã€‚</span></span><br><span class="line">GLFWwindow *window = glfwCreateWindow(WIDTH, HEIGHT, <span class="string">"Learn OpenGL"</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">nullptr</span> == window)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to create GLFW window"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">glfwTerminate();</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">glfwMakeContextCurrent(window);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//GLEWæ˜¯ç”¨æ¥ç®¡ç†OpenGLçš„å‡½æ•°æŒ‡é’ˆçš„ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨ä»»ä½•OpenGLçš„å‡½æ•°ä¹‹å‰æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–GLEW</span></span><br><span class="line">glewExperimental = GL_TRUE;</span><br><span class="line"><span class="keyword">if</span> (GLEW_OK != glewInit()) &#123;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to initialise GLEW"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> screenWidth, screenHeight;</span><br><span class="line">glfwGetFramebufferSize(window, &amp;screenWidth, &amp;screenHeight);</span><br><span class="line">    <span class="comment">/*å¯ä»¥é€šè¿‡è°ƒç”¨glViewportå‡½æ•°æ¥è®¾ç½®çª—å£çš„ç»´åº¦(Dimension)</span></span><br><span class="line"><span class="comment">    å‰ä¸¤ä¸ªå‚æ•°æ§åˆ¶çª—å£å·¦ä¸‹è§’çš„ä½ç½®ï¼›ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå‚æ•°æ§åˆ¶æ¸²æŸ“çª—å£çš„å®½åº¦å’Œé«˜åº¦ï¼ˆåƒç´ ï¼‰*/</span></span><br><span class="line">glViewport(<span class="number">0</span>, <span class="number">0</span>, screenWidth, screenHeight);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*æˆ‘ä»¬å¯ä¸å¸Œæœ›åªç»˜åˆ¶ä¸€ä¸ªå›¾åƒä¹‹åæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°±ç«‹å³é€€å‡ºå¹¶å…³é—­çª—å£ã€‚</span></span><br><span class="line"><span class="comment">    å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­æ·»åŠ ä¸€ä¸ªwhileå¾ªç¯ï¼Œå®ƒèƒ½åœ¨æˆ‘ä»¬è®©GLFWé€€å‡ºå‰ä¸€ç›´ä¿æŒè¿è¡Œã€‚*/</span></span><br><span class="line">    <span class="comment">//glfwWindowShouldCloseå‡½æ•°åœ¨æˆ‘ä»¬æ¯æ¬¡å¾ªç¯çš„å¼€å§‹å‰æ£€æŸ¥ä¸€æ¬¡GLFWæ˜¯å¦è¢«è¦æ±‚é€€å‡ºï¼Œå¦‚æœæ˜¯çš„è¯è¯¥å‡½æ•°è¿”å›trueç„¶åæ¸¸æˆå¾ªç¯ä¾¿ç»“æŸäº†ï¼Œä¹‹åä¸ºæˆ‘ä»¬å°±å¯ä»¥å…³é—­åº”ç”¨ç¨‹åºäº†ã€‚</span></span><br><span class="line"><span class="keyword">while</span> (!glfwWindowShouldClose(window))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">//glfwPollEventså‡½æ•°æ£€æŸ¥æœ‰æ²¡æœ‰è§¦å‘ä»€ä¹ˆäº‹ä»¶ï¼ˆæ¯”å¦‚é”®ç›˜è¾“å…¥ã€é¼ æ ‡ç§»åŠ¨ç­‰ï¼‰ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼ˆå¯ä»¥é€šè¿‡å›è°ƒæ–¹æ³•æ‰‹åŠ¨è®¾ç½®ï¼‰ã€‚æˆ‘ä»¬ä¸€èˆ¬åœ¨æ¸¸æˆå¾ªç¯çš„å¼€å§‹è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°ã€‚</span></span><br><span class="line">glfwPollEvents();</span><br><span class="line">glClearColor(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>);</span><br><span class="line">glClear(GL_COLOR_BUFFER_BIT);</span><br><span class="line">        <span class="comment">//glfwSwapBufferså‡½æ•°ä¼šäº¤æ¢é¢œè‰²ç¼“å†²ï¼ˆå®ƒæ˜¯ä¸€ä¸ªå‚¨å­˜ç€GLFWçª—å£æ¯ä¸€ä¸ªåƒç´ é¢œè‰²çš„å¤§ç¼“å†²ï¼‰ï¼Œå®ƒåœ¨è¿™ä¸€è¿­ä»£ä¸­è¢«ç”¨æ¥ç»˜åˆ¶ï¼Œå¹¶ä¸”å°†ä¼šä½œä¸ºè¾“å‡ºæ˜¾ç¤ºåœ¨å±å¹•ä¸Š</span></span><br><span class="line">glfwSwapBuffers(window);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//å½“æ¸¸æˆå¾ªç¯ç»“æŸåæˆ‘ä»¬éœ€è¦æ­£ç¡®é‡Šæ”¾/åˆ é™¤ä¹‹å‰çš„åˆ†é…çš„æ‰€æœ‰èµ„æºã€‚æˆ‘ä»¬å¯ä»¥åœ¨mainå‡½æ•°çš„æœ€åè°ƒç”¨glfwTerminateå‡½æ•°æ¥é‡Šæ”¾GLFWåˆ†é…çš„å†…å­˜</span></span><br><span class="line">glfwTerminate();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰è§’å½¢"><a class="header-anchor" href="#ä¸‰è§’å½¢"></a>ä¸‰è§’å½¢</h2><p>OpenGLçš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯æŠŠ3Dåæ ‡è½¬å˜ä¸ºé€‚åº”ä½ å±å¹•çš„2Dåƒç´ ã€‚</p><p>3Dåæ ‡è½¬ä¸º2Dåæ ‡çš„å¤„ç†è¿‡ç¨‹æ˜¯ç”±OpenGLçš„<strong>å›¾å½¢æ¸²æŸ“ç®¡çº¿</strong>ï¼ˆGraphics Pipelineï¼Œå¤§å¤šè¯‘ä¸ºç®¡çº¿ï¼Œå®é™…ä¸ŠæŒ‡çš„æ˜¯ä¸€å †åŸå§‹å›¾å½¢æ•°æ®é€”ç»ä¸€ä¸ªè¾“é€ç®¡é“ï¼ŒæœŸé—´ç»è¿‡å„ç§å˜åŒ–å¤„ç†æœ€ç»ˆå‡ºç°åœ¨å±å¹•çš„è¿‡ç¨‹ï¼‰ç®¡ç†çš„ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨"><a class="header-anchor" href="#é¡¶ç‚¹ç€è‰²å™¨"></a>é¡¶ç‚¹ç€è‰²å™¨</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line"><span class="keyword">layout</span> (<span class="keyword">location</span> = <span class="number">0</span>) <span class="keyword">in</span> <span class="type">vec3</span> position;</span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_Position</span> = <span class="type">vec4</span>(position.x, position.y, position.z, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>in</code>å…³é”®å­—ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å£°æ˜æ‰€æœ‰çš„è¾“å…¥é¡¶ç‚¹å±æ€§(Input Vertex Attribute)</p><p>å›¾å½¢æ¸²æŸ“ç®¡çº¿çš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯**é¡¶ç‚¹ç€è‰²å™¨(**Vertex Shader)ï¼Œå®ƒæŠŠä¸€ä¸ªå•ç‹¬çš„é¡¶ç‚¹ä½œä¸ºè¾“å…¥ã€‚ç›®çš„æ˜¯æŠŠ3Dåæ ‡è½¬ä¸ºå¦ä¸€ç§3Dåæ ‡ï¼ŒåŒæ—¶é¡¶ç‚¹ç€è‰²å™¨å…è®¸æˆ‘ä»¬å¯¹é¡¶ç‚¹å±æ€§è¿›è¡Œä¸€äº›åŸºæœ¬å¤„ç†ã€‚</p><p><strong>å›¾å…ƒè£…é…</strong>(Primitive Assembly)é˜¶æ®µå°†é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºçš„æ‰€æœ‰é¡¶ç‚¹ä½œä¸ºè¾“å…¥ï¼Œå¹¶æ‰€æœ‰çš„ç‚¹è£…é…æˆæŒ‡å®šå›¾å…ƒçš„å½¢çŠ¶ï¼›æœ¬èŠ‚ä¾‹å­ä¸­æ˜¯ä¸€ä¸ªä¸‰è§’å½¢ã€‚</p><p>OpenGLæ˜¯ä¸€ä¸ª3Då›¾å½¢åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨OpenGLä¸­æŒ‡å®šçš„æ‰€æœ‰åæ ‡éƒ½æ˜¯3Dåæ ‡ï¼ˆxã€yå’Œzï¼‰ã€‚OpenGLä¸æ˜¯ç®€å•åœ°æŠŠ<strong>æ‰€æœ‰çš„</strong>3Dåæ ‡å˜æ¢ä¸ºå±å¹•ä¸Šçš„2Dåƒç´ ï¼›OpenGLä»…å½“3Dåæ ‡åœ¨3ä¸ªè½´ï¼ˆxã€yå’Œzï¼‰ä¸Šéƒ½ä¸º-1.0åˆ°1.0çš„èŒƒå›´å†…æ—¶æ‰å¤„ç†å®ƒã€‚</p><p>ç”±äºæˆ‘ä»¬å¸Œæœ›æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæˆ‘ä»¬ä¸€å…±è¦æŒ‡å®šä¸‰ä¸ªé¡¶ç‚¹ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ä¸€ä¸ª3Dä½ç½®ã€‚æˆ‘ä»¬ä¼šå°†å®ƒä»¬ä»¥<strong>æ ‡å‡†åŒ–è®¾å¤‡åæ ‡</strong>çš„å½¢å¼ï¼ˆOpenGLçš„å¯è§åŒºåŸŸï¼‰å®šä¹‰ä¸ºä¸€ä¸ª<code>GLfloat</code>æ•°ç»„ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GLfloat vertices[] = &#123;</span><br><span class="line">    <span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">     <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">     <span class="number">0.0f</span>,  <span class="number">0.5f</span>, <span class="number">0.0f</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¸²æŸ“çš„æ˜¯ä¸€ä¸ª2Dä¸‰è§’å½¢ï¼Œå°†å®ƒé¡¶ç‚¹çš„zåæ ‡è®¾ç½®ä¸º0.0ã€‚</p><p>å®šä¹‰é¡¶ç‚¹æ•°æ®ä»¥åï¼Œæˆ‘ä»¬ä¼šæŠŠå®ƒä½œä¸ºè¾“å…¥å‘é€é¡¶ç‚¹ç€è‰²å™¨ã€‚å®ƒä¼šåœ¨GPUä¸Šåˆ›å»ºå†…å­˜ç”¨äºå‚¨å­˜æˆ‘ä»¬çš„é¡¶ç‚¹æ•°æ®ï¼Œè¿˜è¦é…ç½®OpenGLå¦‚ä½•è§£é‡Šè¿™äº›å†…å­˜ï¼Œå¹¶ä¸”æŒ‡å®šå…¶å¦‚ä½•å‘é€ç»™æ˜¾å¡ã€‚é¡¶ç‚¹ç€è‰²å™¨æ¥ç€ä¼šå¤„ç†æˆ‘ä»¬åœ¨å†…å­˜ä¸­æŒ‡å®šæ•°é‡çš„é¡¶ç‚¹ã€‚</p><h3 id="é¡¶ç‚¹ç¼“å­˜å¯¹è±¡vbo"><a class="header-anchor" href="#é¡¶ç‚¹ç¼“å­˜å¯¹è±¡vbo"></a>é¡¶ç‚¹ç¼“å­˜å¯¹è±¡VBO</h3><p>æˆ‘ä»¬é€šè¿‡<strong>é¡¶ç‚¹ç¼“å†²å¯¹è±¡</strong>(Vertex Buffer Objects, VBO)ç®¡ç†è¿™ä¸ªå†…å­˜ï¼Œå®ƒä¼šåœ¨GPUå†…å­˜(é€šå¸¸è¢«ç§°ä¸ºæ˜¾å­˜)ä¸­<strong>å‚¨å­˜å¤§é‡é¡¶ç‚¹</strong>ã€‚</p><p>é¡¶ç‚¹ç¼“å†²å¯¹è±¡æ˜¯æˆ‘ä»¬åœ¨OpenGLæ•™ç¨‹ä¸­ç¬¬ä¸€ä¸ªOpenGLå¯¹è±¡ã€‚è¿™ä¸ªç¼“å†²æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„IDï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<u><em>glGenBuffers</em></u>å‡½æ•°å’Œä¸€ä¸ªç¼“å†²IDç”Ÿæˆä¸€ä¸ªVBOå¯¹è±¡ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLuint VBO;</span><br><span class="line">glGenBuffers(<span class="number">1</span>, &amp;VBO);</span><br></pre></td></tr></table></figure><p>é¡¶ç‚¹ç¼“å†²å¯¹è±¡çš„ç¼“å†²ç±»å‹æ˜¯GL_ARRAY_BUFFER</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<u><em>glBindBuffer</em></u>å‡½æ•°æŠŠæ–°åˆ›å»ºçš„ç¼“å†²ç»‘å®šåˆ°GL_ARRAY_BUFFERç›®æ ‡ä¸Šï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glBindBuffer(GL_ARRAY_BUFFER, VBO);</span><br></pre></td></tr></table></figure><p>ä»è¿™ä¸€åˆ»èµ·ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ä»»ä½•ï¼ˆåœ¨GL_ARRAY_BUFFERç›®æ ‡ä¸Šçš„ï¼‰ç¼“å†²è°ƒç”¨éƒ½ä¼šç”¨æ¥é…ç½®å½“å‰ç»‘å®šçš„ç¼“å†²(VBO)ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥è°ƒç”¨<u><em>glBufferData</em></u>å‡½æ•°ï¼Œå®ƒä¼šæŠŠä¹‹å‰å®šä¹‰çš„é¡¶ç‚¹æ•°æ®å¤åˆ¶åˆ°ç¼“å†²çš„å†…å­˜ä¸­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glBufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br></pre></td></tr></table></figure><p>glBufferDataæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥æŠŠç”¨æˆ·å®šä¹‰çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ç»‘å®šç¼“å†²çš„å‡½æ•°ã€‚</p><ol><li><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡ç¼“å†²çš„ç±»å‹ï¼šé¡¶ç‚¹ç¼“å†²å¯¹è±¡å½“å‰ç»‘å®šåˆ°GL_ARRAY_BUFFERç›®æ ‡ä¸Šã€‚</p></li><li><p>ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¼ è¾“æ•°æ®çš„å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½)ï¼›ç”¨ä¸€ä¸ªç®€å•çš„<code>sizeof</code>è®¡ç®—å‡ºé¡¶ç‚¹æ•°æ®å¤§å°å°±è¡Œã€‚</p></li><li><p>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬å¸Œæœ›å‘é€çš„å®é™…æ•°æ®ã€‚</p></li><li><p>ç¬¬å››ä¸ªå‚æ•°æŒ‡å®šäº†æˆ‘ä»¬å¸Œæœ›æ˜¾å¡å¦‚ä½•ç®¡ç†ç»™å®šçš„æ•°æ®ã€‚å®ƒæœ‰ä¸‰ç§å½¢å¼ï¼š</p></li></ol><ul><li>GL_STATIC_DRAW ï¼šæ•°æ®ä¸ä¼šæˆ–å‡ ä¹ä¸ä¼šæ”¹å˜ã€‚</li><li>GL_DYNAMIC_DRAWï¼šæ•°æ®ä¼šè¢«æ”¹å˜å¾ˆå¤šã€‚</li><li>GL_STREAM_DRAW ï¼šæ•°æ®æ¯æ¬¡ç»˜åˆ¶æ—¶éƒ½ä¼šæ”¹å˜ã€‚</li></ul><p>æˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯åˆ›å»ºä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ï¼Œæ³¨æ„è¿˜æ˜¯ç”¨IDæ¥å¼•ç”¨çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å‚¨å­˜è¿™ä¸ªé¡¶ç‚¹ç€è‰²å™¨ä¸º<code>GLuint</code>ï¼Œç„¶åç”¨<u><em>glCreateShader</em></u>åˆ›å»ºè¿™ä¸ªç€è‰²å™¨ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLuint vertexShader;</span><br><span class="line">vertexShader = glCreateShader(GL_VERTEX_SHADER);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠéœ€è¦åˆ›å»ºçš„ç€è‰²å™¨ç±»å‹ä»¥å‚æ•°å½¢å¼æä¾›ç»™glCreateShaderã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œä¼ é€’çš„å‚æ•°æ˜¯GL_VERTEX_SHADERã€‚</p><p>ä¸‹ä¸€æ­¥æˆ‘ä»¬æŠŠè¿™ä¸ªç€è‰²å™¨æºç é™„åŠ åˆ°ç€è‰²å™¨å¯¹è±¡ä¸Šï¼Œç„¶åç¼–è¯‘å®ƒï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glShaderSource(vertexShader, <span class="number">1</span>, &amp;vertexShaderSource, <span class="literal">NULL</span>);</span><br><span class="line">glCompileShader(vertexShader);</span><br></pre></td></tr></table></figure><p>glShaderSourceå‡½æ•°æŠŠ</p><p>è¦ç¼–è¯‘çš„ç€è‰²å™¨å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p>ç¬¬äºŒå‚æ•°æŒ‡å®šäº†ä¼ é€’çš„æºç å­—ç¬¦ä¸²æ•°é‡ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ªã€‚</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é¡¶ç‚¹ç€è‰²å™¨çœŸæ­£çš„æºç ï¼Œ</p><p>ç¬¬å››ä¸ªå‚æ•°æˆ‘ä»¬å…ˆè®¾ç½®ä¸º<code>NULL</code>ã€‚</p><h3 id="ç‰‡æ®µç€è‰²å™¨"><a class="header-anchor" href="#ç‰‡æ®µç€è‰²å™¨"></a>ç‰‡æ®µç€è‰²å™¨</h3><p>ç‰‡æ®µç€è‰²å™¨(Fragment Shader)æ˜¯ç¬¬äºŒä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªæˆ‘ä»¬æ‰“ç®—åˆ›å»ºçš„ç”¨äºæ¸²æŸ“ä¸‰è§’å½¢çš„ç€è‰²å™¨ã€‚ç‰‡æ®µç€è‰²å™¨å…¨æ˜¯å…³äºè®¡ç®—ä½ çš„åƒç´ æœ€åçš„é¢œè‰²è¾“å‡ºã€‚</p><p>ç‰‡æ®µç€è‰²å™¨åªéœ€è¦ä¸€ä¸ªè¾“å‡ºå˜é‡ï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ª4åˆ†é‡å‘é‡ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æœ€ç»ˆçš„è¾“å‡ºé¢œè‰²</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> color;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    color = <span class="type">vec4</span>(<span class="number">1.0</span>f, <span class="number">0.5</span>f, <span class="number">0.2</span>f, <span class="number">1.0</span>f);<span class="comment">//ç¬¬å››ä¸ªå‚æ•° 1.0ä»£è¡¨å®Œå…¨ä¸é€æ˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>out</code>å…³é”®å­—å£°æ˜è¾“å‡ºå˜é‡</p><p>ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨çš„è¿‡ç¨‹ä¸é¡¶ç‚¹ç€è‰²å™¨ç±»ä¼¼ï¼Œåªä¸è¿‡æˆ‘ä»¬ä½¿ç”¨GL_FRAGMENT_SHADERå¸¸é‡ä½œä¸ºç€è‰²å™¨ç±»å‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GLuint fragmentShader;</span><br><span class="line">fragmentShader = glCreateShader(GL_FRAGMENT_SHADER);</span><br><span class="line">glShaderSource(fragmentShader, <span class="number">1</span>, &amp;fragmentShaderSource, null);</span><br><span class="line">glCompileShader(fragmentShader);</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªç€è‰²å™¨ç°åœ¨éƒ½ç¼–è¯‘äº†ï¼Œå‰©ä¸‹çš„äº‹æƒ…æ˜¯æŠŠä¸¤ä¸ªç€è‰²å™¨å¯¹è±¡é“¾æ¥åˆ°ä¸€ä¸ªç”¨æ¥æ¸²æŸ“çš„ç€è‰²å™¨ç¨‹åº(Shader Program)ä¸­ã€‚</p><h3 id="ç€è‰²å™¨ç¨‹åº"><a class="header-anchor" href="#ç€è‰²å™¨ç¨‹åº"></a>ç€è‰²å™¨ç¨‹åº</h3><p>ç€è‰²å™¨ç¨‹åºå¯¹è±¡(Shader Program Object)æ˜¯å¤šä¸ªç€è‰²å™¨åˆå¹¶ä¹‹åå¹¶æœ€ç»ˆé“¾æ¥å®Œæˆçš„ç‰ˆæœ¬ã€‚</p><p>åˆ›å»ºä¸€ä¸ªç¨‹åºå¯¹è±¡å¾ˆç®€å•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLuint shaderProgram;</span><br><span class="line">shaderProgram &#x3D; glCreateProgram();</span><br></pre></td></tr></table></figure><p>glCreateProgramå‡½æ•°åˆ›å»ºä¸€ä¸ªç¨‹åºï¼Œå¹¶è¿”å›æ–°åˆ›å»ºç¨‹åºå¯¹è±¡çš„IDå¼•ç”¨ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦æŠŠä¹‹å‰ç¼–è¯‘çš„ç€è‰²å™¨é™„åŠ åˆ°ç¨‹åºå¯¹è±¡ä¸Šï¼Œç„¶åç”¨glLinkProgramé“¾æ¥å®ƒä»¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">glAttachShader(shaderProgram, vertexShader);</span><br><span class="line">glAttachShader(shaderProgram, fragmentShader);</span><br><span class="line">glLinkProgram(shaderProgram);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠç€è‰²å™¨é™„åŠ åˆ°äº†ç¨‹åºä¸Šï¼Œç„¶åç”¨glLinkProgramé“¾æ¥ã€‚</p><p>å¾—åˆ°çš„ç»“æœå°±æ˜¯ä¸€ä¸ªç¨‹åºå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨glUseProgramå‡½æ•°ï¼Œç”¨åˆšåˆ›å»ºçš„ç¨‹åºå¯¹è±¡ä½œä¸ºå®ƒçš„å‚æ•°ï¼Œä»¥æ¿€æ´»è¿™ä¸ªç¨‹åºå¯¹è±¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glUseProgram(shaderProgram);</span><br></pre></td></tr></table></figure><p>åœ¨glUseProgramå‡½æ•°è°ƒç”¨ä¹‹åï¼Œæ¯ä¸ªç€è‰²å™¨è°ƒç”¨å’Œæ¸²æŸ“è°ƒç”¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç¨‹åºå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ä¹‹å‰å†™çš„ç€è‰²å™¨)äº†ã€‚</p><p>å¯¹äº†ï¼Œåœ¨æŠŠç€è‰²å™¨å¯¹è±¡é“¾æ¥åˆ°ç¨‹åºå¯¹è±¡ä»¥åï¼Œè®°å¾—åˆ é™¤ç€è‰²å™¨å¯¹è±¡ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦å®ƒä»¬äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glDeleteShader(vertexShader);</span><br><span class="line">glDeleteShader(fragmentShader);</span><br></pre></td></tr></table></figure><h3 id="é“¾æ¥é¡¶ç‚¹å±æ€§"><a class="header-anchor" href="#é“¾æ¥é¡¶ç‚¹å±æ€§"></a>é“¾æ¥é¡¶ç‚¹å±æ€§</h3><p>é¡¶ç‚¹ç€è‰²å™¨å…è®¸æˆ‘ä»¬æŒ‡å®šä»»ä½•ä»¥é¡¶ç‚¹å±æ€§ä¸ºå½¢å¼çš„è¾“å…¥ã€‚æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨æŒ‡å®šè¾“å…¥æ•°æ®çš„å“ªä¸€ä¸ªéƒ¨åˆ†å¯¹åº”é¡¶ç‚¹ç€è‰²å™¨çš„å“ªä¸€ä¸ªé¡¶ç‚¹å±æ€§ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ¸²æŸ“å‰æŒ‡å®šOpenGLè¯¥å¦‚ä½•è§£é‡Šé¡¶ç‚¹æ•°æ®ã€‚</p><p>æˆ‘ä»¬çš„é¡¶ç‚¹ç¼“å†²æ•°æ®ä¼šè¢«è§£æä¸ºä¸‹é¢è¿™æ ·å­ï¼š</p><p><img src="https://learnopengl-cn.readthedocs.io/zh/latest/img/01/04/vertex_attribute_pointer.png" alt="img"></p><ul><li>ä½ç½®æ•°æ®è¢«å‚¨å­˜ä¸º32-bitï¼ˆ4å­—èŠ‚ï¼‰æµ®ç‚¹å€¼ã€‚</li><li>æ¯ä¸ªä½ç½®åŒ…å«3ä¸ªè¿™æ ·çš„å€¼ã€‚</li><li>åœ¨è¿™3ä¸ªå€¼ä¹‹é—´æ²¡æœ‰ç©ºéš™ï¼ˆæˆ–å…¶ä»–å€¼ï¼‰ã€‚è¿™å‡ ä¸ªå€¼åœ¨æ•°ç»„ä¸­ç´§å¯†æ’åˆ—ã€‚</li><li>æ•°æ®ä¸­ç¬¬ä¸€ä¸ªå€¼åœ¨ç¼“å†²å¼€å§‹çš„ä½ç½®ã€‚</li></ul><p>æœ‰äº†è¿™äº›ä¿¡æ¯æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨glVertexAttribPointerå‡½æ•°å‘Šè¯‰OpenGLè¯¥å¦‚ä½•è§£æé¡¶ç‚¹æ•°æ®ï¼ˆåº”ç”¨åˆ°é€ä¸ªé¡¶ç‚¹å±æ€§ä¸Šï¼‰äº†ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="keyword">sizeof</span>(GLfloat), (GLvoid*)<span class="number">0</span>);</span><br><span class="line">glEnableVertexAttribArray(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>glVertexAttribPointerå‡½æ•°çš„å‚æ•°éå¸¸å¤šï¼Œæ‰€ä»¥æˆ‘ä¼šé€ä¸€ä»‹ç»å®ƒä»¬ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šæˆ‘ä»¬è¦é…ç½®çš„é¡¶ç‚¹å±æ€§ã€‚è¿˜è®°å¾—æˆ‘ä»¬åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ä½¿ç”¨<code>layout(location = 0)</code>å®šä¹‰äº†positioné¡¶ç‚¹å±æ€§çš„ä½ç½®å€¼(Location)å—ï¼Ÿå®ƒå¯ä»¥æŠŠé¡¶ç‚¹å±æ€§çš„ä½ç½®å€¼è®¾ç½®ä¸º<code>0</code>ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›æŠŠæ•°æ®ä¼ é€’åˆ°è¿™ä¸€ä¸ªé¡¶ç‚¹å±æ€§ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¼ å…¥<code>0</code>ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šé¡¶ç‚¹å±æ€§çš„å¤§å°ã€‚é¡¶ç‚¹å±æ€§æ˜¯ä¸€ä¸ª<code>vec3</code>ï¼Œå®ƒç”±3ä¸ªå€¼ç»„æˆï¼Œæ‰€ä»¥å¤§å°æ˜¯3ã€‚</li><li>ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šæ•°æ®çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯GL_FLOAT(GLSLä¸­<code>vec*</code>éƒ½æ˜¯ç”±æµ®ç‚¹æ•°å€¼ç»„æˆçš„)ã€‚</li><li>ä¸‹ä¸ªå‚æ•°å®šä¹‰æˆ‘ä»¬æ˜¯å¦å¸Œæœ›æ•°æ®è¢«æ ‡å‡†åŒ–(Normalize)ã€‚å¦‚æœæˆ‘ä»¬è®¾ç½®ä¸ºGL_TRUEï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šè¢«æ˜ å°„åˆ°0ï¼ˆå¯¹äºæœ‰ç¬¦å·å‹signedæ•°æ®æ˜¯-1ï¼‰åˆ°1ä¹‹é—´ã€‚æˆ‘ä»¬æŠŠå®ƒè®¾ç½®ä¸ºGL_FALSEã€‚</li><li>ç¬¬äº”ä¸ªå‚æ•°å«åšæ­¥é•¿(Stride)ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬åœ¨è¿ç»­çš„é¡¶ç‚¹å±æ€§ç»„ä¹‹é—´çš„é—´éš”ã€‚ç”±äºä¸‹ä¸ªç»„ä½ç½®æ•°æ®åœ¨3ä¸ª<code>GLfloat</code>ä¹‹åï¼Œæˆ‘ä»¬æŠŠæ­¥é•¿è®¾ç½®ä¸º<code>3 * sizeof(GLfloat)</code>ã€‚è¦æ³¨æ„çš„æ˜¯ç”±äºæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°ç»„æ˜¯ç´§å¯†æ’åˆ—çš„ï¼ˆåœ¨ä¸¤ä¸ªé¡¶ç‚¹å±æ€§ä¹‹é—´æ²¡æœ‰ç©ºéš™ï¼‰æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®ä¸º0æ¥è®©OpenGLå†³å®šå…·ä½“æ­¥é•¿æ˜¯å¤šå°‘ï¼ˆåªæœ‰å½“æ•°å€¼æ˜¯ç´§å¯†æ’åˆ—æ—¶æ‰å¯ç”¨ï¼‰ã€‚ä¸€æ—¦æˆ‘ä»¬æœ‰æ›´å¤šçš„é¡¶ç‚¹å±æ€§ï¼Œæˆ‘ä»¬å°±å¿…é¡»æ›´å°å¿ƒåœ°å®šä¹‰æ¯ä¸ªé¡¶ç‚¹å±æ€§ä¹‹é—´çš„é—´éš”ï¼Œæˆ‘ä»¬åœ¨åé¢ä¼šçœ‹åˆ°æ›´å¤šçš„ä¾‹å­(è¯‘æ³¨: è¿™ä¸ªå‚æ•°çš„æ„æ€ç®€å•è¯´å°±æ˜¯ä»è¿™ä¸ªå±æ€§ç¬¬äºŒæ¬¡å‡ºç°çš„åœ°æ–¹åˆ°æ•´ä¸ªæ•°ç»„0ä½ç½®ä¹‹é—´æœ‰å¤šå°‘å­—èŠ‚)ã€‚</li><li>æœ€åä¸€ä¸ªå‚æ•°çš„ç±»å‹æ˜¯<code>GLvoid*</code>ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è¿›è¡Œè¿™ä¸ªå¥‡æ€ªçš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å®ƒè¡¨ç¤ºä½ç½®æ•°æ®åœ¨ç¼“å†²ä¸­èµ·å§‹ä½ç½®çš„åç§»é‡(Offset)ã€‚ç”±äºä½ç½®æ•°æ®åœ¨æ•°ç»„çš„å¼€å¤´ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯0ã€‚æˆ‘ä»¬ä¼šåœ¨åé¢è¯¦ç»†è§£é‡Šè¿™ä¸ªå‚æ•°ã€‚</li></ul><blockquote><p>æ¯ä¸ªé¡¶ç‚¹å±æ€§ä»ä¸€ä¸ªVBOç®¡ç†çš„å†…å­˜ä¸­è·å¾—å®ƒçš„æ•°æ®ï¼Œè€Œå…·ä½“æ˜¯ä»å“ªä¸ªVBOï¼ˆç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªVBOï¼‰è·å–åˆ™æ˜¯é€šè¿‡åœ¨è°ƒç”¨glVetexAttribPointeræ—¶ç»‘å®šåˆ°GL_ARRAY_BUFFERçš„VBOå†³å®šçš„ã€‚ç”±äºåœ¨è°ƒç”¨glVetexAttribPointerä¹‹å‰ç»‘å®šçš„æ˜¯å…ˆå‰å®šä¹‰çš„VBOå¯¹è±¡ï¼Œé¡¶ç‚¹å±æ€§<code>0</code>ç°åœ¨ä¼šé“¾æ¥åˆ°å®ƒçš„é¡¶ç‚¹æ•°æ®ã€‚</p></blockquote><p>åœ¨OpenGLä¸­ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“ï¼Œä»£ç ä¼šåƒæ˜¯è¿™æ ·ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0. å¤åˆ¶é¡¶ç‚¹æ•°ç»„åˆ°ç¼“å†²ä¸­ä¾›OpenGLä½¿ç”¨</span></span><br><span class="line">glBindBuffer(GL_ARRAY_BUFFER, VBO);</span><br><span class="line">glBufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class="line"><span class="comment">// 1. è®¾ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆ</span></span><br><span class="line">glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="keyword">sizeof</span>(GLfloat), (GLvoid*)<span class="number">0</span>);</span><br><span class="line"><span class="comment">//glEnableVertexAttribArrayï¼Œä»¥é¡¶ç‚¹å±æ€§ä½ç½®å€¼ä½œä¸ºå‚æ•°ï¼Œå¯ç”¨é¡¶ç‚¹å±æ€§ï¼›</span></span><br><span class="line">glEnableVertexAttribArray(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 2. å½“æˆ‘ä»¬æ¸²æŸ“ä¸€ä¸ªç‰©ä½“æ—¶è¦ä½¿ç”¨ç€è‰²å™¨ç¨‹åº</span></span><br><span class="line">glUseProgram(shaderProgram);</span><br><span class="line"><span class="comment">// 3. ç»˜åˆ¶ç‰©ä½“</span></span><br><span class="line">someOpenGLFunctionThatDrawsOurTriangle();</span><br></pre></td></tr></table></figure><h3 id="é¡¶ç‚¹æ•°ç»„å¯¹è±¡vao"><a class="header-anchor" href="#é¡¶ç‚¹æ•°ç»„å¯¹è±¡vao"></a>é¡¶ç‚¹æ•°ç»„å¯¹è±¡VAO</h3><p>é¡¶ç‚¹æ•°ç»„å¯¹è±¡(Vertex Array Object, VAO)å¯ä»¥åƒé¡¶ç‚¹ç¼“å†²å¯¹è±¡é‚£æ ·è¢«ç»‘å®šï¼Œä»»ä½•éšåçš„é¡¶ç‚¹å±æ€§è°ƒç”¨éƒ½ä¼šå‚¨å­˜åœ¨è¿™ä¸ªVAOä¸­ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯ï¼Œå½“é…ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆæ—¶ï¼Œä½ åªéœ€è¦å°†é‚£äº›è°ƒç”¨æ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åå†ç»˜åˆ¶ç‰©ä½“çš„æ—¶å€™åªéœ€è¦ç»‘å®šç›¸åº”çš„VAOå°±è¡Œäº†ã€‚</p><p>ä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ä¼šå‚¨å­˜ä»¥ä¸‹è¿™äº›å†…å®¹ï¼š</p><ul><li>glEnableVertexAttribArrayå’ŒglDisableVertexAttribArrayçš„è°ƒç”¨ã€‚</li><li>é€šè¿‡glVertexAttribPointerè®¾ç½®çš„é¡¶ç‚¹å±æ€§é…ç½®ã€‚</li><li>é€šè¿‡<code>glVertexAttribPointer</code>è°ƒç”¨è¿›è¡Œçš„é¡¶ç‚¹ç¼“å†²å¯¹è±¡ä¸é¡¶ç‚¹å±æ€§é“¾æ¥ã€‚</li></ul><p>åˆ›å»ºä¸€ä¸ªVAOå’Œåˆ›å»ºä¸€ä¸ªVBOå¾ˆç±»ä¼¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLuint VAO;</span><br><span class="line">glGenVertexArrays(1, &amp;VAO);</span><br></pre></td></tr></table></figure><p>è¦æƒ³ä½¿ç”¨VAOï¼Œè¦åšçš„åªæ˜¯ä½¿ç”¨glBindVertexArrayç»‘å®šVAOã€‚ä»ç»‘å®šä¹‹åèµ·ï¼Œæˆ‘ä»¬åº”è¯¥ç»‘å®šå’Œé…ç½®å¯¹åº”çš„VBOå’Œå±æ€§æŒ‡é’ˆï¼Œä¹‹åè§£ç»‘VAOä¾›ä¹‹åä½¿ç”¨ã€‚å½“æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªè¦åœ¨ç»˜åˆ¶ç‰©ä½“å‰ç®€å•åœ°æŠŠVAOç»‘å®šåˆ°å¸Œæœ›ä½¿ç”¨çš„è®¾å®šä¸Šå°±è¡Œäº†ã€‚è¿™æ®µä»£ç åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ..:: åˆå§‹åŒ–ä»£ç ï¼ˆåªè¿è¡Œä¸€æ¬¡ (é™¤éä½ çš„ç‰©ä½“é¢‘ç¹æ”¹å˜)ï¼‰ :: ..</span></span><br><span class="line"><span class="comment">// 1. ç»‘å®šVAO</span></span><br><span class="line">glBindVertexArray(VAO);</span><br><span class="line">    <span class="comment">// 2. æŠŠé¡¶ç‚¹æ•°ç»„å¤åˆ¶åˆ°ç¼“å†²ä¸­ä¾›OpenGLä½¿ç”¨</span></span><br><span class="line">    glBindBuffer(GL_ARRAY_BUFFER, VBO);</span><br><span class="line">    glBufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class="line">    <span class="comment">// 3. è®¾ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆ</span></span><br><span class="line">    glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="keyword">sizeof</span>(GLfloat), (GLvoid*)<span class="number">0</span>);</span><br><span class="line">    glEnableVertexAttribArray(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//4. è§£ç»‘VAO</span></span><br><span class="line">glBindVertexArray(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ..:: ç»˜åˆ¶ä»£ï¼ˆæ¸¸æˆå¾ªç¯ä¸­ï¼‰ :: ..</span></span><br><span class="line"><span class="comment">// 5. ç»˜åˆ¶ç‰©ä½“</span></span><br><span class="line">glUseProgram(shaderProgram);</span><br><span class="line">glBindVertexArray(VAO);</span><br><span class="line">someOpenGLFunctionThatDrawsOurTriangle();</span><br><span class="line">glBindVertexArray(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>è¦æƒ³ç»˜åˆ¶æˆ‘ä»¬æƒ³è¦çš„ç‰©ä½“ï¼ŒOpenGLç»™æˆ‘ä»¬æä¾›äº†glDrawArrayså‡½æ•°ï¼Œå®ƒä½¿ç”¨å½“å‰æ¿€æ´»çš„ç€è‰²å™¨ï¼Œä¹‹å‰å®šä¹‰çš„é¡¶ç‚¹å±æ€§é…ç½®ï¼Œå’ŒVBOçš„é¡¶ç‚¹æ•°æ®ï¼ˆé€šè¿‡VAOé—´æ¥ç»‘å®šï¼‰æ¥ç»˜åˆ¶å›¾å…ƒã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">glUseProgram(shaderProgram);</span><br><span class="line">glBindVertexArray(VAO);</span><br><span class="line">glDrawArrays(GL_TRIANGLES, 0, 3);</span><br><span class="line">glBindVertexArray(0);</span><br></pre></td></tr></table></figure><p>glDrawArrayså‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶çš„OpenGLå›¾å…ƒçš„ç±»å‹ã€‚ç”±äºæˆ‘ä»¬åœ¨ä¸€å¼€å§‹æ—¶è¯´è¿‡ï¼Œæˆ‘ä»¬å¸Œæœ›ç»˜åˆ¶çš„æ˜¯ä¸€ä¸ªä¸‰è§’å½¢ï¼Œè¿™é‡Œä¼ é€’GL_TRIANGLESç»™å®ƒã€‚ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šäº†é¡¶ç‚¹æ•°ç»„çš„èµ·å§‹ç´¢å¼•ï¼Œæˆ‘ä»¬è¿™é‡Œå¡«<code>0</code>ã€‚æœ€åä¸€ä¸ªå‚æ•°æŒ‡å®šæˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶å¤šå°‘ä¸ªé¡¶ç‚¹ï¼Œè¿™é‡Œæ˜¯3ï¼ˆæˆ‘ä»¬åªä»æˆ‘ä»¬çš„æ•°æ®ä¸­æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢ï¼Œå®ƒåªæœ‰3ä¸ªé¡¶ç‚¹é•¿ï¼‰ã€‚</p><h3 id="ç´¢å¼•ç¼“å†²å¯¹è±¡"><a class="header-anchor" href="#ç´¢å¼•ç¼“å†²å¯¹è±¡"></a>ç´¢å¼•ç¼“å†²å¯¹è±¡</h3><p>åœ¨æ¸²æŸ“é¡¶ç‚¹è¿™ä¸€è¯é¢˜ä¸Šæˆ‘ä»¬è¿˜æœ‰æœ€æœ‰ä¸€ä¸ªéœ€è¦è®¨è®ºçš„ä¸œè¥¿â€”â€”ç´¢å¼•ç¼“å†²å¯¹è±¡(Element Buffer Objectï¼ŒEBOï¼Œä¹Ÿå«Index Buffer Objectï¼ŒIBO)ã€‚è¦è§£é‡Šç´¢å¼•ç¼“å†²å¯¹è±¡çš„å·¥ä½œæ–¹å¼æœ€å¥½è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬ä¸å†ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢è€Œæ˜¯ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢ã€‚æˆ‘ä»¬å¯ä»¥ç»˜åˆ¶ä¸¤ä¸ªä¸‰è§’å½¢æ¥ç»„æˆä¸€ä¸ªçŸ©å½¢ï¼ˆOpenGLä¸»è¦å¤„ç†ä¸‰è§’å½¢ï¼‰ã€‚è¿™ä¼šç”Ÿæˆä¸‹é¢çš„é¡¶ç‚¹çš„é›†åˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GLfloat vertices[] &#x3D; &#123;</span><br><span class="line">    &#x2F;&#x2F; ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</span><br><span class="line">    0.5f, 0.5f, 0.0f,   &#x2F;&#x2F; å³ä¸Šè§’</span><br><span class="line">    0.5f, -0.5f, 0.0f,  &#x2F;&#x2F; å³ä¸‹è§’</span><br><span class="line">    -0.5f, 0.5f, 0.0f,  &#x2F;&#x2F; å·¦ä¸Šè§’</span><br><span class="line">    &#x2F;&#x2F; ç¬¬äºŒä¸ªä¸‰è§’å½¢</span><br><span class="line">    0.5f, -0.5f, 0.0f,  &#x2F;&#x2F; å³ä¸‹è§’</span><br><span class="line">    -0.5f, -0.5f, 0.0f, &#x2F;&#x2F; å·¦ä¸‹è§’</span><br><span class="line">    -0.5f, 0.5f, 0.0f   &#x2F;&#x2F; å·¦ä¸Šè§’</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å‡ ä¸ªé¡¶ç‚¹å åŠ äº†ã€‚æˆ‘ä»¬æŒ‡å®šäº†<code>å³ä¸‹è§’</code>å’Œ<code>å·¦ä¸Šè§’</code>ä¸¤æ¬¡ï¼ä¸€ä¸ªçŸ©å½¢åªæœ‰4ä¸ªè€Œä¸æ˜¯6ä¸ªé¡¶ç‚¹ï¼Œè¿™æ ·å°±äº§ç”Ÿ50%çš„é¢å¤–å¼€é”€ã€‚å½“æˆ‘ä»¬æœ‰åŒ…æ‹¬ä¸Šåƒä¸ªä¸‰è§’å½¢çš„æ¨¡å‹ä¹‹åè¿™ä¸ªé—®é¢˜ä¼šæ›´ç³Ÿç³•ï¼Œè¿™ä¼šäº§ç”Ÿä¸€å¤§å †æµªè´¹ã€‚æ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯åªå‚¨å­˜ä¸åŒçš„é¡¶ç‚¹ï¼Œå¹¶è®¾å®šç»˜åˆ¶è¿™äº›é¡¶ç‚¹çš„é¡ºåºã€‚è¿™æ ·å­æˆ‘ä»¬åªè¦å‚¨å­˜4ä¸ªé¡¶ç‚¹å°±èƒ½ç»˜åˆ¶çŸ©å½¢äº†ï¼Œä¹‹ååªè¦æŒ‡å®šç»˜åˆ¶çš„é¡ºåºå°±è¡Œäº†ã€‚å¦‚æœOpenGLæä¾›è¿™ä¸ªåŠŸèƒ½å°±å¥½äº†ï¼Œå¯¹å§ï¼Ÿ</p><p>å¾ˆå¹¸è¿ï¼Œç´¢å¼•ç¼“å†²å¯¹è±¡çš„å·¥ä½œæ–¹å¼æ­£æ˜¯è¿™æ ·çš„ã€‚å’Œé¡¶ç‚¹ç¼“å†²å¯¹è±¡ä¸€æ ·ï¼ŒEBOä¹Ÿæ˜¯ä¸€ä¸ªç¼“å†²ï¼Œå®ƒä¸“é—¨å‚¨å­˜ç´¢å¼•ï¼ŒOpenGLè°ƒç”¨è¿™äº›é¡¶ç‚¹çš„ç´¢å¼•æ¥å†³å®šè¯¥ç»˜åˆ¶å“ªä¸ªé¡¶ç‚¹ã€‚æ‰€è°“çš„ç´¢å¼•ç»˜åˆ¶(Indexed Drawing)æ­£æ˜¯æˆ‘ä»¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¦å®šä¹‰ï¼ˆç‹¬ä¸€æ— äºŒçš„ï¼‰é¡¶ç‚¹ï¼Œå’Œç»˜åˆ¶å‡ºçŸ©å½¢æ‰€éœ€çš„ç´¢å¼•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GLfloat vertices[] &#x3D; &#123;</span><br><span class="line">    0.5f, 0.5f, 0.0f,   &#x2F;&#x2F; å³ä¸Šè§’</span><br><span class="line">    0.5f, -0.5f, 0.0f,  &#x2F;&#x2F; å³ä¸‹è§’</span><br><span class="line">    -0.5f, -0.5f, 0.0f, &#x2F;&#x2F; å·¦ä¸‹è§’</span><br><span class="line">    -0.5f, 0.5f, 0.0f   &#x2F;&#x2F; å·¦ä¸Šè§’</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">GLuint indices[] &#x3D; &#123; &#x2F;&#x2F; æ³¨æ„ç´¢å¼•ä»0å¼€å§‹! </span><br><span class="line">    0, 1, 3, &#x2F;&#x2F; ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</span><br><span class="line">    1, 2, 3  &#x2F;&#x2F; ç¬¬äºŒä¸ªä¸‰è§’å½¢</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå½“æ—¶ç”¨ç´¢å¼•çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªå®šä¹‰äº†4ä¸ªé¡¶ç‚¹ï¼Œè€Œä¸æ˜¯6ä¸ªã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦åˆ›å»ºç´¢å¼•ç¼“å†²å¯¹è±¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLuint EBO;</span><br><span class="line">glGenBuffers(1, &amp;EBO);</span><br></pre></td></tr></table></figure><p>ä¸VBOç±»ä¼¼ï¼Œæˆ‘ä»¬å…ˆç»‘å®šEBOç„¶åç”¨glBufferDataæŠŠç´¢å¼•å¤åˆ¶åˆ°ç¼“å†²é‡Œã€‚åŒæ ·ï¼Œå’ŒVBOç±»ä¼¼ï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™äº›å‡½æ•°è°ƒç”¨æ”¾åœ¨ç»‘å®šå’Œè§£ç»‘å‡½æ•°è°ƒç”¨ä¹‹é—´ï¼Œåªä¸è¿‡è¿™æ¬¡æˆ‘ä»¬æŠŠç¼“å†²çš„ç±»å‹å®šä¹‰ä¸ºGL_ELEMENT_ARRAY_BUFFERã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span><br><span class="line">glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);</span><br></pre></td></tr></table></figure><p>è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¼ é€’äº†GL_ELEMENT_ARRAY_BUFFERå½“ä½œç¼“å†²ç›®æ ‡ã€‚æœ€åä¸€ä»¶è¦åšçš„äº‹æ˜¯ç”¨glDrawElementsæ¥æ›¿æ¢glDrawArrayså‡½æ•°ï¼Œæ¥æŒ‡æ˜æˆ‘ä»¬ä»ç´¢å¼•ç¼“å†²æ¸²æŸ“ã€‚ä½¿ç”¨glDrawElementsæ—¶ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å½“å‰ç»‘å®šçš„ç´¢å¼•ç¼“å†²å¯¹è±¡ä¸­çš„ç´¢å¼•è¿›è¡Œç»˜åˆ¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span><br><span class="line">glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†æˆ‘ä»¬ç»˜åˆ¶çš„æ¨¡å¼ï¼Œè¿™ä¸ªå’ŒglDrawArraysçš„ä¸€æ ·ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶é¡¶ç‚¹çš„ä¸ªæ•°ï¼Œè¿™é‡Œå¡«6ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸€å…±éœ€è¦ç»˜åˆ¶6ä¸ªé¡¶ç‚¹ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç´¢å¼•çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯GL_UNSIGNED_INTã€‚æœ€åä¸€ä¸ªå‚æ•°é‡Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šEBOä¸­çš„åç§»é‡ï¼ˆæˆ–è€…ä¼ é€’ä¸€ä¸ªç´¢å¼•æ•°ç»„ï¼Œä½†æ˜¯è¿™æ˜¯å½“ä½ ä¸åœ¨ä½¿ç”¨ç´¢å¼•ç¼“å†²å¯¹è±¡çš„æ—¶å€™ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šåœ¨è¿™é‡Œå¡«å†™0ã€‚</p><p>glDrawElementså‡½æ•°ä»å½“å‰ç»‘å®šåˆ°GL_ELEMENT_ARRAY_BUFFERç›®æ ‡çš„EBOä¸­è·å–ç´¢å¼•ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»åœ¨æ¯æ¬¡è¦ç”¨ç´¢å¼•æ¸²æŸ“ä¸€ä¸ªç‰©ä½“æ—¶ç»‘å®šç›¸åº”çš„EBOï¼Œè¿™è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ã€‚ä¸è¿‡é¡¶ç‚¹æ•°ç»„å¯¹è±¡åŒæ ·å¯ä»¥ä¿å­˜ç´¢å¼•ç¼“å†²å¯¹è±¡çš„ç»‘å®šçŠ¶æ€ã€‚VAOç»‘å®šæ—¶æ­£åœ¨ç»‘å®šçš„ç´¢å¼•ç¼“å†²å¯¹è±¡ä¼šè¢«ä¿å­˜ä¸ºVAOçš„å…ƒç´ ç¼“å†²å¯¹è±¡ã€‚ç»‘å®šVAOçš„åŒæ—¶ä¹Ÿä¼šè‡ªåŠ¨ç»‘å®šEBOã€‚</p><p>æœ€åçš„åˆå§‹åŒ–å’Œç»˜åˆ¶ä»£ç ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ..:: åˆå§‹åŒ–ä»£ç  :: ..</span></span><br><span class="line"><span class="comment">// 1. ç»‘å®šé¡¶ç‚¹æ•°ç»„å¯¹è±¡</span></span><br><span class="line">glBindVertexArray(VAO);</span><br><span class="line">    <span class="comment">// 2. æŠŠæˆ‘ä»¬çš„é¡¶ç‚¹æ•°ç»„å¤åˆ¶åˆ°ä¸€ä¸ªé¡¶ç‚¹ç¼“å†²ä¸­ï¼Œä¾›OpenGLä½¿ç”¨</span></span><br><span class="line">    glBindBuffer(GL_ARRAY_BUFFER, VBO);</span><br><span class="line">    glBufferData(GL_ARRAY_BUFFER, <span class="keyword">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class="line">    <span class="comment">// 3. å¤åˆ¶æˆ‘ä»¬çš„ç´¢å¼•æ•°ç»„åˆ°ä¸€ä¸ªç´¢å¼•ç¼“å†²ä¸­ï¼Œä¾›OpenGLä½¿ç”¨</span></span><br><span class="line">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span><br><span class="line">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class="keyword">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class="line">    <span class="comment">// 3. è®¾å®šé¡¶ç‚¹å±æ€§æŒ‡é’ˆ</span></span><br><span class="line">    glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="keyword">sizeof</span>(GLfloat), (GLvoid*)<span class="number">0</span>);</span><br><span class="line">    glEnableVertexAttribArray(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 4. è§£ç»‘VAOï¼ˆä¸æ˜¯EBOï¼ï¼‰</span></span><br><span class="line">glBindVertexArray(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ..:: ç»˜åˆ¶ä»£ç ï¼ˆæ¸¸æˆå¾ªç¯ä¸­ï¼‰ :: ..</span></span><br><span class="line"></span><br><span class="line">glUseProgram(shaderProgram);</span><br><span class="line">glBindVertexArray(VAO);</span><br><span class="line">glDrawElements(GL_TRIANGLES, <span class="number">6</span>, GL_UNSIGNED_INT, <span class="number">0</span>)</span><br><span class="line">glBindVertexArray(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h3 id="colorfulğŸ”º"><a class="header-anchor" href="#colorfulğŸ”º"></a>colorfulğŸ”º</h3><p>æŠŠé¢œè‰²æ•°æ®åŠ è¿›é¡¶ç‚¹æ•°æ®ä¸­ã€‚æˆ‘ä»¬å°†æŠŠé¢œè‰²æ•°æ®æ·»åŠ ä¸º3ä¸ªfloatå€¼è‡³verticesæ•°ç»„ã€‚æˆ‘ä»¬å°†æŠŠä¸‰è§’å½¢çš„ä¸‰ä¸ªè§’åˆ†åˆ«æŒ‡å®šä¸ºçº¢è‰²ã€ç»¿è‰²å’Œè“è‰²ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GLfloat vertices[] = &#123;</span><br><span class="line">    <span class="comment">// ä½ç½®              // é¢œè‰²</span></span><br><span class="line">     <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>,   <span class="comment">// å³ä¸‹</span></span><br><span class="line">    <span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>,   <span class="comment">// å·¦ä¸‹</span></span><br><span class="line">     <span class="number">0.0f</span>,  <span class="number">0.5f</span>, <span class="number">0.0f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>    <span class="comment">// é¡¶éƒ¨</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç”±äºç°åœ¨æœ‰æ›´å¤šçš„æ•°æ®è¦å‘é€åˆ°é¡¶ç‚¹ç€è‰²å™¨ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å»è°ƒæ•´ä¸€ä¸‹é¡¶ç‚¹ç€è‰²å™¨ï¼Œä½¿å®ƒèƒ½å¤Ÿæ¥æ”¶é¢œè‰²å€¼ä½œä¸ºä¸€ä¸ªé¡¶ç‚¹å±æ€§è¾“å…¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ç”¨<code>layout</code>æ ‡è¯†ç¬¦æ¥æŠŠcolorå±æ€§çš„ä½ç½®å€¼è®¾ç½®ä¸º1ï¼š</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line"><span class="keyword">layout</span> (<span class="keyword">location</span> = <span class="number">0</span>) <span class="keyword">in</span> <span class="type">vec3</span> position; <span class="comment">// ä½ç½®å˜é‡çš„å±æ€§ä½ç½®å€¼ä¸º 0 </span></span><br><span class="line"><span class="keyword">layout</span> (<span class="keyword">location</span> = <span class="number">1</span>) <span class="keyword">in</span> <span class="type">vec3</span> color;    <span class="comment">// é¢œè‰²å˜é‡çš„å±æ€§ä½ç½®å€¼ä¸º 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec3</span> ourColor; <span class="comment">// å‘ç‰‡æ®µç€è‰²å™¨è¾“å‡ºä¸€ä¸ªé¢œè‰²</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_Position</span> = <span class="type">vec4</span>(position, <span class="number">1.0</span>);</span><br><span class="line">    ourColor = color; <span class="comment">// å°†ourColorè®¾ç½®ä¸ºæˆ‘ä»¬ä»é¡¶ç‚¹æ•°æ®é‚£é‡Œå¾—åˆ°çš„è¾“å…¥é¢œè‰²</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘ä»¬ä¸å†ä½¿ç”¨uniformæ¥ä¼ é€’ç‰‡æ®µçš„é¢œè‰²äº†ï¼Œç°åœ¨ä½¿ç”¨<code>ourColor</code>è¾“å‡ºå˜é‡ï¼Œæˆ‘ä»¬å¿…é¡»å†ä¿®æ”¹ä¸€ä¸‹ç‰‡æ®µç€è‰²å™¨ï¼š</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line"><span class="keyword">in</span> <span class="type">vec3</span> ourColor;</span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> color;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    color = <span class="type">vec4</span>(ourColor, <span class="number">1.0</span>f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘ä»¬æ·»åŠ äº†å¦ä¸€ä¸ªé¡¶ç‚¹å±æ€§ï¼Œå¹¶ä¸”æ›´æ–°äº†VBOçš„å†…å­˜ï¼Œæˆ‘ä»¬å°±å¿…é¡»é‡æ–°é…ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆã€‚æ›´æ–°åçš„VBOå†…å­˜ä¸­çš„æ•°æ®ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><p><img src="https://learnopengl-cn.readthedocs.io/zh/latest/img/01/05/vertex_attribute_pointer_interleaved.png" alt="img"></p><p>çŸ¥é“äº†ç°åœ¨ä½¿ç”¨çš„å¸ƒå±€ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨glVertexAttribPointerå‡½æ•°æ›´æ–°é¡¶ç‚¹æ ¼å¼ï¼Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½ç½®å±æ€§</span></span><br><span class="line">glVertexAttribPointer(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">6</span> * <span class="keyword">sizeof</span>(GLfloat), (GLvoid*)<span class="number">0</span>);</span><br><span class="line">glEnableVertexAttribArray(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// é¢œè‰²å±æ€§</span></span><br><span class="line">glVertexAttribPointer(<span class="number">1</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">6</span> * <span class="keyword">sizeof</span>(GLfloat), (GLvoid*)(<span class="number">3</span>* <span class="keyword">sizeof</span>(GLfloat)));</span><br><span class="line">glEnableVertexAttribArray(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>glVertexAttribPointerå‡½æ•°çš„å‰å‡ ä¸ªå‚æ•°æ¯”è¾ƒæ˜äº†ã€‚è¿™æ¬¡æˆ‘ä»¬é…ç½®å±æ€§ä½ç½®å€¼ä¸º1çš„é¡¶ç‚¹å±æ€§ã€‚é¢œè‰²å€¼æœ‰3ä¸ªfloaté‚£ä¹ˆå¤§ï¼Œæˆ‘ä»¬ä¸å»æ ‡å‡†åŒ–è¿™äº›å€¼ã€‚</p><p>ç”±äºæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸¤ä¸ªé¡¶ç‚¹å±æ€§ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é‡æ–°è®¡ç®—<strong>æ­¥é•¿</strong>å€¼ã€‚ä¸ºè·å¾—æ•°æ®é˜Ÿåˆ—ä¸­ä¸‹ä¸€ä¸ªå±æ€§å€¼ï¼ˆæ¯”å¦‚ä½ç½®å‘é‡çš„ä¸‹ä¸ª<code>x</code>åˆ†é‡ï¼‰æˆ‘ä»¬å¿…é¡»å‘å³ç§»åŠ¨6ä¸ªfloatï¼Œå…¶ä¸­3ä¸ªæ˜¯ä½ç½®å€¼ï¼Œå¦å¤–3ä¸ªæ˜¯é¢œè‰²å€¼ã€‚è¿™ä½¿æˆ‘ä»¬çš„æ­¥é•¿å€¼ä¸º6ä¹˜ä»¥floatçš„å­—èŠ‚æ•°ï¼ˆ=24å­—èŠ‚ï¼‰ã€‚<br>åŒæ ·ï¼Œè¿™æ¬¡æˆ‘ä»¬å¿…é¡»æŒ‡å®šä¸€ä¸ªåç§»é‡ã€‚å¯¹äºæ¯ä¸ªé¡¶ç‚¹æ¥è¯´ï¼Œä½ç½®é¡¶ç‚¹å±æ€§åœ¨å‰ï¼Œæ‰€ä»¥å®ƒçš„åç§»é‡æ˜¯0ã€‚é¢œè‰²å±æ€§ç´§éšä½ç½®æ•°æ®ä¹‹åï¼Œæ‰€ä»¥åç§»é‡å°±æ˜¯<code>3 * sizeof(GLfloat)</code>ï¼Œç”¨å­—èŠ‚æ¥è®¡ç®—å°±æ˜¯12å­—èŠ‚ã€‚</p><p>è¿è¡Œç¨‹åºä½ åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š</p><p><img src="https://learnopengl-cn.readthedocs.io/zh/latest/img/01/05/shaders3.png" alt="img"></p><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºå›¾å½¢å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenGL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« </title>
      <link href="/2019/09/27/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0/"/>
      <url>/2019/09/27/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="æ­å»ºåšå®¢"><a class="header-anchor" href="#æ­å»ºåšå®¢"></a>æ­å»ºåšå®¢</h2><ol><li>å®‰è£…nodeå’Œgit</li></ol><p>åœ¨Windowsä¸­æŸ¥çœ‹æ˜¯å¦æˆåŠŸå®‰è£…node<br>win + R è¾“å…¥cmdæ‰“å¼€å‘½ä»¤è¡Œçª—å£<br>è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure><p>å›è½¦åçœ‹åˆ°ç‰ˆæœ¬å·</p><a id="more"></a><p>è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>åŒæ ·çœ‹åˆ°ç‰ˆæœ¬å·å³è¡¨ç¤ºå®‰è£…æˆåŠŸ</p><p>2.å®‰è£…hexo</p><ol><li>å®‰è£…cnpm</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç›¸åº”ä¿¡æ¯</p><ol start="2"><li>å®‰è£…hexo</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåå¯è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p>éªŒè¯æ˜¯å¦æˆåŠŸ</p><p>3.é€‰æ‹©ä¸€ä¸ªè·¯å¾„ï¼Œæ–°å»ºæ–‡ä»¶å¤¹blog(å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–åç§°)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir blog</span><br><span class="line"><span class="built_in">cd</span> blog     //è¿›å…¥blogæ–‡ä»¶å¤¹</span><br><span class="line">hexo init  //åˆå§‹åŒ–æ–‡ä»¶å¤¹ï¼Œæ¼«é•¿çš„ç­‰å¾…ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°äº†é”™è¯¯ï¼Œå¯ä»¥åˆ æ‰blogæ–‡ä»¶å¤¹ï¼Œä»æ–°å»ºæ–‡ä»¶å¤¹blogé‡æ–°å¼€å§‹<br>æˆåŠŸåå¯ä»¥çœ‹åˆ°blogæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†ä¸€äº›æ–‡ä»¶<br>ç„¶åå°±å¯ä»¥å¯åŠ¨åšå®¢äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨è¾“å…¥localhost:4000å›è½¦å°±å¯ä»¥çœ‹åˆ°åšå®¢äº†<br>å¦‚ä¸‹å›¾<br><img src="https://img-blog.csdnimg.cn/20190927224717553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JsdWVweWFuZw==,size_16,color_FFFFFF,t_70" alt="åšå®¢é¡µé¢"><br>é»˜è®¤ç”Ÿæˆäº†ä¸€ç¯‡Hello Worldçš„æ–‡ç« </p><h3 id="æ–°å»ºæ–‡ç« "><a class="header-anchor" href="#æ–°å»ºæ–‡ç« "></a>æ–°å»ºæ–‡ç« </h3><p>æ­å»ºå®Œæˆåå°±å¯ä»¥å†™åšå®¢æ–‡ç« å•¦<br>å…ˆCTRL Cæ–­å¼€<br>ç„¶åè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="string">"æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« "</span></span><br><span class="line">//å¯ä»¥çœ‹åˆ°åœ¨ä»¥ä¸‹è·¯å¾„ä¸­åˆ›å»ºäº†ä¸€ä¸ª.mdæ–‡ä»¶</span><br><span class="line">INFO  Created: D:\hexo\blog\<span class="built_in">source</span>\_posts\æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« .md</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°è¯¥æ–‡ä»¶ç”¨ç¼–è¾‘å™¨ç¼–è¾‘(vscodeã€notepad++ç­‰)<br>ç¼–è¾‘å®Œåä¿å­˜é€€å‡º<br>è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥ç”Ÿæˆæ–‡ç« äº†<br>å†è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>æ‰“å¼€localhost:4000å°±å¯ä»¥çœ‹åˆ°åˆšåˆšå†™çš„åšå®¢äº†</p><h2 id="éƒ¨ç½²åˆ°github"><a class="header-anchor" href="#éƒ¨ç½²åˆ°github"></a>éƒ¨ç½²åˆ°github</h2><ol><li>åœ¨GitHubä¸­new repository<br>ä»“åº“å:  â€œGitHubè´¦å·åç§°â€.github.io</li><li>å®‰è£…æ’ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install --save hexo-deployer-git</span><br></pre></td></tr></table></figure><ol><li>ä¿®æ”¹é…ç½®æ–‡ä»¶<br>æ‰¾åˆ°blogæ–‡ä»¶å¤¹ä¸­çš„_config.yml<br>ç”¨ç¼–è¾‘å™¨æ‰“å¼€<br>åœ¨æœ€åé¢æ‰¾åˆ°Deployment<br>ä¿®æ”¹æˆå¦‚ä¸‹</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/<span class="string">"GitHubè´¦å·"</span>/<span class="string">"GitHubè´¦å·æ˜µç§°"</span>.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>ä¿å­˜é€€å‡º</p><ol start="4"><li>éƒ¨ç½²</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥åœ¨GitHubä¸­çœ‹åˆ°éƒ¨ç½²çš„æ–‡ä»¶äº†<br>ä»¥åç›´æ¥åœ¨æµè§ˆå™¨è¾“å…¥&quot;GitHubè´¦å·æ˜µç§°&quot;.github.io.git<br>å°±å¯ä»¥åœ¨å…¬ç½‘è®¿é—®ä¸ªäººåšå®¢äº†</p><h2 id="æ›´æ”¹hexoä¸»é¢˜"><a class="header-anchor" href="#æ›´æ”¹hexoä¸»é¢˜"></a>æ›´æ”¹hexoä¸»é¢˜</h2><ol><li>ä¸‹è½½ä¸»é¢˜</li></ol><p>åœ¨GitHubä¸Šæ‰¾åˆ°çš„ä¸€ä¸ªä¸»é¢˜<br>cloneåˆ°æœ¬åœ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¿®æ”¹é…ç½®æ–‡ä»¶<br>æ‰¾åˆ°blogæ–‡ä»¶å¤¹ä¸­çš„_config.yml<br>ç”¨ç¼–è¾‘å™¨æ‰“å¼€<br>æ‰¾åˆ°theme<br>å°†landscapeä¿®æ”¹ä¸ºyilia</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line">theme: landscape</span><br></pre></td></tr></table></figure><p>ä¿å­˜é€€å‡º</p><ol start="3"><li>é‡æ–°ç”Ÿæˆï¼Œå¯åŠ¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line">hexo d//æ¨é€åˆ°GitHub</span><br></pre></td></tr></table></figure><h2 id="the-end"><a class="header-anchor" href="#the-end"></a>The End</h2><p>ãŠ—ï¸æ­å–œä½ çœ‹å®Œäº†è¿™ç¯‡æ–‡ç« ï¼</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®å’Œæƒ³æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶</p><p>ğŸ“§ <a href="mailto:yll1671158@163.com">æˆ‘çš„é‚®ç®±</a></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
